<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:hftl="http://hftl.org"
	xmlns:hf="http://java.sun.com/jsf/composite/tags"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:e="http://primefaces.org/extension"
	template="/layout/template.xhtml">

	<ui:define name="navigation">
		<ui:include src="/layout/navigation.xhtml" />
	</ui:define>

	<ui:define name="body">

		<!-- updateField=":formPanel:formId:subscriptionTable" -->
		<hftl:entityPopup id="subscription"
			header="#{messages['subscription.popup.header']}"
			backingBean="#{subscriptionBean}" eventBackingBean="#{accessBean}"
			updateField=":#{p:component('subscriptionOutputPanel')}"
			selection="#{accessBean.selectedSubscription}"
			searchField1Label="#{messages['subscription.code']}"
			searchField1="code"
			searchField2Label="#{messages['subscription.description']}"
			searchField2="description"
			column1Label="#{messages['subscription.code']}" column1="code"
			column2Label="#{messages['subscription.description']}"
			column2="description" filtersMap="#{subscriptionBean.filters}">
		</hftl:entityPopup>


		<hf:formPanel id="formPanel" label="#{messages['access.accessPanel']}"
			backingBean="#{accessBean}" columns="1">
			<hf:formField label="#{messages['access.accessUserId']}"
				field="accessUserId" />
			<hf:formField label="#{messages['access.discriminatorCode']}"
				field="discriminatorCode" />
			<hf:formField label="#{messages['access.startDate']}"
				field="startDate" />
			<hf:formField label="#{messages['access.endDate']}" field="endDate" />
		</hf:formPanel>

		<h:form>
			<p:outputPanel id="subscriptionOutputPanel">
				<p:dataTable id="subscriptionTable" var="s"
					value="#{accessBean.entity.subscriptions}" rowKey="#{entity.id}">

					<f:facet name="header">#{messages['subscription.title']}</f:facet>

					<p:column headerText="#{messages['subscription.code']}">#{s.code}</p:column>
					<p:column headerText="#{messages['subscription.description']}">#{s.description}</p:column>
					<p:column>
						<p:tooltip for="deletelink" value="#{messages['commons.delete']}"
							showEffect="slide" hideEffect="slide" />
						<p:commandButton id="deletelink"
							action="#{accessBean.delete(accessBean.entity.id)}" icon="ui-icon-trash"
							ajax="true" />
					</p:column>

					<!-- <hftl:actionsColumn useCustomIdParam="true"
						renderDeleteLink="false"
						permission="#{identity.hasPermission('billing','billingManagement')}" /> -->

					<f:facet name="footer">
						<p:commandButton value="#{messages['commons.addNew']}" ajax="true"
							rendered="#{accessBean.edit}" icon="ui-icon-search"
							oncomplete="dlg_subscription.show()" />
					</f:facet>

				</p:dataTable>
			</p:outputPanel>
		</h:form>

	</ui:define>

</ui:composition>
