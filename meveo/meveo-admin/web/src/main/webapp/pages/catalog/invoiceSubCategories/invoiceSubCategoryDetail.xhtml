<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j" xmlns:hftl="http://hftl.org"
	xmlns:hf="http://java.sun.com/jsf/composite/tags"
	xmlns:p="http://primefaces.org/ui" template="/layout/template.xhtml">

	<ui:define name="navigation">
		<ui:include src="/layout/navigation.xhtml" />
	</ui:define>

	<ui:define name="body">

		<hftl:entityPopup id="invSubCatCountryPopup"
			header="#{messages['tradingCountry.popup.header']}"  
			updateField=":tabView:formPanelTax:formTax:countrySelectedId:countrySelectedId_text"
			  selection="#{invoiceSubcategoryCountry.tradingCountry}"
			  backingBean="#{tradingCountryBean}"
			searchField1Label="#{messages['businessEntity.code']}"
			searchField1="countryCode"
			column1Label="#{messages['businessEntity.code']}"
			column1="countryCode"
			column2Label="#{messages['businessEntity.description']}"
			column2="prDescription" />

		<hftl:entityPopup id="searchInvoiceCategoryPopup"
			header="#{messages['invoiceCategory.panel']}"
			updateField=":tabView:formPanel:formId:categorySelectId:categorySelectId_text"
			selection="#{invoiceSubCategoryBean.entity.invoiceCategory}"
			backingBean="#{invoiceCategoryBean}"
			searchField1Label="#{messages['invoiceCategory.code']}"
			searchField1="code"
			searchField2Label="#{messages['invoiceCategory.description']}"
			searchField2="description"
			column1Label="#{messages['invoiceCategory.code']}" column1="code"
			column2Label="#{messages['invoiceCategory.description']}"
			column2="description" />

		<hftl:entityPopup id="invSubCatCountTaxPopup"
			header="#{messages['tax.panel']}" backingBean="#{taxBean}"
			updateField=":tabView:formPanelTax:formTax:taxSelectedId:taxSelectedId_text"
			  selection="#{invoiceSubcategoryCountry.tax}"
			searchField1Label="#{messages['tax.code']}" searchField1="code"
			searchField2Label="#{messages['tax.description']}"
			searchField2="description" column1Label="#{messages['tax.code']}"
			column1="code" column2Label="#{messages['tax.description']}"
			column2="description" />

	
<p:panelGrid columns="1"> 
			<f:facet name="header">
				<h:outputText value="#{messages['invoiceSubCategory.panel']}" />
			</f:facet>
<p:tabView id="tabView">
				<p:tab title="#{messages['invoiceSubCategory.tab1']}">

					
<hf:formPanel id="formPanel"
						label=""
						backingBean="#{invoiceSubCategoryBean}">

						<hf:formEntityField id="categorySelectId"
							label="#{messages['invoiceSubCategory.invoiceCategory']}"
							field="invoiceCategory" childField="code" required="true"
							popup="true" popupId="searchInvoiceCategoryPopup" />

						<hf:formField label="#{messages['invoiceSubCategory.code']}"
							field="code" required="true" validateUnique="true"
							useConverter="false"
							disabled="#{invoiceSubCategoryBean.entity.id!=null}" />

						<hf:languageFields />

						<hftl:fieldset
							name="#{messages['invoiceSubCategory.accountingCode']}"
							columns="4">

							<p:outputLabel for="accountingField1"
								value="#{messages['invoiceSubCategory.accountingCodeField1']}" />
							<p:inputText rendered="#{invoiceSubCategoryBean.edit}"
								id="accountingField1"
								value="#{invoiceSubCategoryBean.accountingCodeField1}" size="5"
								maxlength="5" required="true" />
							<h:outputText rendered="#{!invoiceSubCategoryBean.edit}"
								value="#{invoiceSubCategoryBean.accountingCodeField1}"
								style="font-weight:bold;" />

							<p:outputLabel for="accountingField2"
								value="#{messages['invoiceSubCategory.accountingCodeField2']}" />
							<p:inputText rendered="#{invoiceSubCategoryBean.edit}"
								id="accountingField2"
								value="#{invoiceSubCategoryBean.accountingCodeField2}" size="8"
								maxlength="8" required="true" />
							<h:outputText rendered="#{!invoiceSubCategoryBean.edit}"
								value="#{invoiceSubCategoryBean.accountingCodeField2}"
								style="font-weight:bold;" />

							<p:outputLabel for="accountingField3"
								value="#{messages['invoiceSubCategory.accountingCodeField3']}" />
							<p:inputText rendered="#{invoiceSubCategoryBean.edit}"
								id="accountingField3"
								value="#{invoiceSubCategoryBean.accountingCodeField3}" size="5"
								maxlength="5" required="true" />
							<h:outputText rendered="#{!invoiceSubCategoryBean.edit}"
								value="#{invoiceSubCategoryBean.accountingCodeField3}"
								style="font-weight:bold;" />

							<p:outputLabel for="accountingField4"
								value="#{messages['invoiceSubCategory.accountingCodeField4']}" />
							<p:inputText rendered="#{invoiceSubCategoryBean.edit}"
								id="accountingField4"
								value="#{invoiceSubCategoryBean.accountingCodeField4}" size="3"
								maxlength="3" required="true" />
							<h:outputText rendered="#{!invoiceSubCategoryBean.edit}"
								value="#{invoiceSubCategoryBean.accountingCodeField4}"
								style="font-weight:bold;" />

							<p:outputLabel for="accountingField6"
								value="#{messages['invoiceSubCategory.accountingCodeField6']}" />
							<p:inputText rendered="#{invoiceSubCategoryBean.edit}"
								id="accountingField6"
								value="#{invoiceSubCategoryBean.accountingCodeField6}" size="8"
								maxlength="8" required="true" />
							<h:outputText rendered="#{!invoiceSubCategoryBean.edit}"
								value="#{invoiceSubCategoryBean.accountingCodeField6}"
								style="font-weight:bold;" />

							<p:outputLabel for="accountingField7"
								value="#{messages['invoiceSubCategory.accountingCodeField7']}" />
							<p:inputText rendered="#{invoiceSubCategoryBean.edit}"
								id="accountingField7"
								value="#{invoiceSubCategoryBean.accountingCodeField7}" size="5"
								maxlength="5" required="true" />
							<h:outputText rendered="#{!invoiceSubCategoryBean.edit}"
								value="#{invoiceSubCategoryBean.accountingCodeField7}"
								style="font-weight:bold;" />

						</hftl:fieldset>
</hf:formPanel>
					

				</p:tab>

				<p:tab title="#{messages['invoiceSubCategory.tab2']}" id="tab2">

					<p:outputPanel id="invoiceSubCategoryCountries_MSG_panel">
						<h:graphicImage value="/img/msgerror.png" style="border:0"
							rendered="#{validation.failed}" />
						<h:outputText value="#{messages['validation.validationFailure']}"
							rendered="#{validation.failed}" styleClass="errorMessage" />
					</p:outputPanel>

					<p:panelGrid columns="2">

						<h:outputText value="#{messages['invoiceSubCategory.code']}" />
						<p:panelGrid columns="2">
							<h:outputText id="invoiceSubCategoryCode"
								value="#{invoiceSubCategoryBean.entity.code}" required="true"
								disabled="true" style="font-weight:bold;" />
							<h:inputHidden rendered="#{invoiceSubCategoryBean.edit}" />
						</p:panelGrid>

						<h:outputText
							value="#{messages['invoiceSubCategory.description']}" />
						<p:panelGrid columns="2">
							<h:outputText
								value="#{invoiceSubCategoryBean.entity.description}"
								required="true" disabled="true" style="font-weight:bold;" />
							<h:inputHidden rendered="#{invoiceSubCategoryBean.edit}" />
						</p:panelGrid>

					</p:panelGrid>

					<br />

					<p:outputPanel id="invoiceSubCategoryCountries_panel">
						<hftl:dataList backingBean="#{invoiceSubCategoryCountryBean}" dataModel="#{invoiceSubCategoryBean.entity.invoiceSubcategoryCountries}"
							resultsId="invoiceSubCategoryCountries_results" checkMany="false">
						<hftl:column
								label="#{messages['invoiceSubCategoryCountry.countryCode']}"
								field="tradingCountry" childField="countryCode" />
							<hftl:column
								label="#{messages['invoiceSubCategoryCountry.taxe']}"
								field="tax" childField="code" />
							<p:column styleClass="actions-column" rendered="#{invoiceSubCategoryBean.edit}">
								<f:facet name="header">
									<h:outputText value="#{messages['commons.actions']}" />
								</f:facet>
									
								<p:tooltip for="editSubCategoryCountryLink"
									value="#{messages['commons.edit']}" showEffect="slide"
									hideEffect="slide" />
								<p:commandButton id="editSubCategoryCountryLink" 	update=":tabView:formPanelTax:formTax"
									action="#{invoiceSubCategoryBean.editInvoiceSubcategoryCountry(entity)}"
									icon="ui-icon-document"/>
								<p:tooltip for="editSubCategoryCountrydeletelink"
									value="#{messages['commons.delete']}" showEffect="slide"
									hideEffect="slide" />
								<p:commandButton id="editSubCategoryCountrydeletelink"
									action="#{invoiceSubCategoryBean.deleteInvoiceSubcategoryCountry(entity)}" icon="ui-icon-trash"
									ajax="true" update=":tabView:invoiceSubCategoryCountries_panel,:tabView:formPanelTax:formTax"/>	
									
									
							</p:column>
						</hftl:dataList>
					</p:outputPanel>
					<p:panel>
						

						<p:panel id="subCategoryCountrydiv" rendered="#{invoiceSubCategoryBean.edit}">


							<p:panel id="subCategoryCountrySdiv">
								<hf:formPanel id="formPanelTax" formId="formTax" edit="#{invoiceSubCategoryBean.edit}"
									label="#{messages['invoiceSubCategoryCountry.panel']}"
									backingBean="#{invoiceSubCategoryBean}" entity="#{invoiceSubcategoryCountry}"
									 showFormButtons="false"
									ajaxSubmit="true">
 

									 <hf:formEntityField id="countrySelectedId"
										label="#{messages['address.country']}" field="tradingCountry"
										childField="countryCode" popup="true"
										popupId="invSubCatCountryPopup" required="true" /> 

									 <hf:formEntityField id="taxSelectedId"
										label="#{messages['invoiceSubCategoryCountry.taxe']}"
										field="tax" childField="code" popup="true"
										popupId="invSubCatCountTaxPopup" required="true" /> 

									<p:panelGrid columns="2">

										<p:commandButton
											action="#{invoiceSubCategoryBean.saveInvoiceSubCategoryCountry}"
											value="#{messages['action.save']}"
											update=":tabView:invoiceSubCategoryCountries_panel,:tabView:formPanelTax:formTax,:tabView:subCategoryCountrydiv"
											oncomplete="document.getElementById('subCategoryCountrydiv');" />

										<p:button value="#{messages['action.cancel']}"
											action="#{invoiceSubCategoryBean.newInvoiceSubcategoryCountryInstance}"
											update=":tabView:subCategoryCountrydiv" />
									</p:panelGrid>

								</hf:formPanel>
							</p:panel>

						</p:panel>

					</p:panel>
				</p:tab>

			</p:tabView>
		</p:panelGrid>
	</ui:define>

</ui:composition>
