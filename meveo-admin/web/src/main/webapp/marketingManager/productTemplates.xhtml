<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:hftl="http://hftl.org"
	xmlns:hf="http://java.sun.com/jsf/composite/tags"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui" xmlns:o="http://omnifaces.org/ui"
	template="/marketingManager/layout/template.xhtml">
	<ui:define name="metadata">
		<f:metadata>
			<f:event type="preRenderView"
				listener="#{productTemplateListBean.preRenderView}" />
		</f:metadata>
	</ui:define>

	<ui:define name="navigation">
		<ui:include src="/marketingManager/layout/navigation.xhtml" />
	</ui:define>

	<ui:define name="body">
		<h:form id="productTemplateForm">
			<p:panel id="headerPanel">
				<p:breadCrumb homeDisplay="text" id="crumbmenu">
					<p:menuitem value="#{messages['menu.catalog']}" disabled="true" />
					<p:menuitem outcome="mmProductTemplates"
						value="#{messages['productTemplates.search']}" />
				</p:breadCrumb>
				<p:panel style="width: 50%">
					<p:panelGrid columns="2" styleClass="ui-panelgrid-blank">
						<p:panel>
							<h:form>
								<ul class="ListNoStyle">
									<li class="Padding5">
										<div class="btn-wrapper">
											<i class="fa fa-plus text-red"></i>
											<p:link styleClass="no-text-decoration"
												outcome="mmProductTemplateDetail"
												value="#{messages['productTemplate.newProduct']}">
												<f:param name="cid"
													value="#{javax.enterprise.context.conversation.id}" />
												<f:param name="edit" value="true" />
												<f:param name="editMode" value="edit" />
											</p:link>
										</div> <!-- / btn-wrapper -->
									</li>
								</ul>
								<ul class="ListNoStyle">
									<li class="Padding5">
										<div class="btn-wrapper">
											<i class="fa fa-plus text-red"></i>
											<p:link styleClass="no-text-decoration"
												outcome="mmBundleTemplateDetail"
												value="#{messages['productTemplate.createBundle']}">
												<f:param name="cid"
													value="#{javax.enterprise.context.conversation.id}" />
												<f:param name="edit" value="true" />
												<f:param name="editMode" value="edit" />
											</p:link>
										</div> <!-- / btn-wrapper -->
									</li>
								</ul>

							</h:form>
						</p:panel>

						<p:panel>
							<ul class="ListNoStyle">
								<li class="Padding5"><span class="fa fa-check-square-o"></span>
									#{productTemplateListBean.activeProductCount}
									#{messages['productTemplate.activeProductsNum']}</li>
								<li class="Padding5"><span class="fa fa-close"></span>
									#{productTemplateListBean.inactiveProductCount}
									#{messages['productTemplate.deactivatedProductsNum']}</li>
								<li class="Padding5"><span class="fa fa-exclamation-circle"></span>
									#{productTemplateListBean.almostExpiredCount}
									#{messages['productTemplate.expiringProductsNum']}</li>
							</ul>
						</p:panel>
					</p:panelGrid>
				</p:panel>
				<p:panel id="ptToExport" styleClass="Wid50 TexAlRight">
					<div class="Container">
						<p:panel styleClass="Container60 VAlignTop">
							<h:form>
								<div class="search-wrapper">
									<p:inputText placeholder="#{messages['action.search']}"
										value="#{productTemplateListBean.filters['description']}" />
									<p:commandLink styleClass="Padding3 fa fa-search"
										update=":productTemplateForm:tabView:productTemplateList"></p:commandLink>
								</div>
							</h:form>
						</p:panel>
						<p:panel columns="1" styleClass="Container40 no-border-radius"
							style="border: 1px solid #ddd" id="offerForExportPanel">
							<ul class="list-unstyled">
								<li class="Padding5"><i class="fa fa-share-square-o"
									style="margin-right: 5px;"></i> <p:commandLink
										value="#{productTemplateListBean.ptToExport.size()} #{messages['productTemplate.selectedProductsfoExportNum']}">
									</p:commandLink></li>
								<li class="Padding5">
									<div class="FRight">
										<p:selectOneMenu id="exportToList"
											value="#{productTemplateListBean.meveoInstanceToExport}">
											<f:selectItem itemLabel="" />
											<f:selectItems
												value="#{productTemplateListBean.meveoInstances}" var="mi"
												itemValue="#{mi}" itemLabel="#{mi.code}" />
										</p:selectOneMenu>
									</div>
								</li>
							</ul>
						</p:panel>
					</div>
				</p:panel>
			</p:panel>

			<p:tabView id="tabView" styleClass="no-border-radius offer-wrapper">
				<p:tab title="#{messages['marketingManager.catalog.view.detailed']}">
					<p:dataGrid id="productTemplateList"
						value="#{productTemplateListBean.productTemplates}" var="prod"
						paginator="true" rows="10" columns="1" layout="grid"
						paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
						lazy="true" styleClass="dataGrid custom-grid ui-datagrid-blank"
						rowsPerPageTemplate="10,15,20,50" rowKey="#{prod.id}">
						<p:panel styleClass="Wid40 VAlignTop">
							<p:panelGrid columns="4"
								styleClass="panelGrid ui-panelgrid-blank"
								columnClasses="Wid5 VAlignTop, Wid54 VAlignTop, Wid40 VAlignTop">
								<p:panel>
									<p:graphicImage id="productImage" cache="false"
										value="#{productTemplateImageStreamer.image}" height="100"
										width="100">
										<f:param name="id" value="#{prod.id}"></f:param>
									</p:graphicImage>
								</p:panel>
								<p:panel>
									<p:panelGrid columns="1" styleClass="ui-panelgrid-blank">
										<h:outputText value="#{prod.nameOrCode}"></h:outputText>
										<ui:repeat value="#{prod.offerTemplateCategories.toArray()}"
											var="c" varStatus="status">
											<c:set var="valueLabel" value="#{c}" />
											<c:set var="valueLabel"
												value="#{valueLabel['descriptionOrCode']}" />
											<h:outputText value="#{valueLabel}" />
											<h:outputText value=", " rendered="#{not status.last}" />
										</ui:repeat>
										<h:outputText
											value="#{messages['offerTemplate.bom']}: #{prod.businessProductModel.code}"
											rendered="#{prod.businessProductModel != null}"></h:outputText>
										<p:separator></p:separator>
										<h:outputText value="#{messages['commons.validFrom']}: "></h:outputText>
										<h:outputText value="#{prod.validFrom} ">
											<f:convertDateTime type="date"
												pattern="#{paramBean.getProperty('meveo.dateTimeFormat','dd/MM/yyyy HH:mm')}" />
										</h:outputText>
										<h:outputText value="#{messages['commons.validTo']}: "></h:outputText>
										<h:outputText value="#{prod.validTo} ">
											<f:convertDateTime type="date"
												pattern="#{paramBean.getProperty('meveo.dateTimeFormat','dd/MM/yyyy HH:mm')}" />
										</h:outputText>
									</p:panelGrid>
								</p:panel>
								<p:panel>
									<p:panel styleClass="TexAlRight">
										<div class="FRight">
											<p:inputSwitch value="#{prod.active}" disabled="true"
												onLabel="#{messages['accountStatusEnum.active']}"
												offLabel="#{messages['accountStatusEnum.inactive']}"></p:inputSwitch>
										</div>
										<div class="FRight"
											style="padding-top: 5px; margin-right: 10px;">#{messages['commons.status']}</div>
									</p:panel>
									<p:panel>
										<ul class="ListNoStyle" style="margin: 0px; padding: 0px;">
											<li class="Padding5 FRight"><p:commandLink
													styleClass="fa fa-share-square-o text-red"
													action="#{productTemplateListBean.addProductTemplateToExport(prod)}"
													update=":productTemplateForm:ptToExport">
												</p:commandLink></li>
											<li class="Padding5 FRight"><p:link
													styleClass="fa fa-copy no-text-decoration"
													outcome="mmProductTemplateDetail">
													<f:param name="objectId" value="#{prod.id}"></f:param>
													<f:param name="cid"
														value="#{javax.enterprise.context.conversation.id}" />
													<f:param name="edit" value="true" />
													<f:param name="editMode" value="dup" />
													<f:param name="backView" value="mmProductTemplates"></f:param>
												</p:link></li>
											<li class="Padding5 FRight"><p:link
													styleClass="fa fa-edit no-text-decoration text-red"
													outcome="mmProductTemplateDetail"
													rendered="#{not productTemplateBean.isBundleTemplate(prod)}">
													<f:param name="objectId" value="#{prod.id}" />
													<f:param name="cid"
														value="#{javax.enterprise.context.conversation.id}" />
													<f:param name="edit" value="true" />
													<f:param name="editMode" value="edit" />
													<f:param name="backView" value="mmProductTemplates"></f:param>
												</p:link> <p:link styleClass="fa fa-edit no-text-decoration text-red"
													outcome="mmBundleTemplateDetail"
													rendered="#{productTemplateBean.isBundleTemplate(prod)}">
													<f:param name="objectId" value="#{prod.id}"></f:param>
													<f:param name="cid"
														value="#{javax.enterprise.context.conversation.id}" />
													<f:param name="edit" value="true" />
													<f:param name="editMode" value="edit" />
													<f:param name="backView" value="mmProductTemplates"></f:param>
												</p:link></li>
											<li class="Padding5 FRight"><p:link
													outcome="mmProductTemplateDetail"
													styleClass="fa fa-search-plus no-text-decoration text-red">
													<f:param name="cid"
														value="#{javax.enterprise.context.conversation.id}" />
													<f:param name="objectId" value="#{prod.id}"></f:param>
													<f:param name="edit" value="false"></f:param>
													<f:param name="backView" value="mmProductTemplates"></f:param>
													<f:param name="tab" value="0"></f:param>
												</p:link></li>
										</ul>
									</p:panel>
								</p:panel>
							</p:panelGrid>
						</p:panel>
					</p:dataGrid>
				</p:tab>

				<p:tab id="tab1"
					title="#{messages['marketingManager.catalog.view.condensed']}">
					<hftl:dataList id="dataList" backingBean="#{offerTemplateListBean}"
						dataModel="#{productTemplateListBean.productTemplates}"
						checkMany="false" exportToCsv="false" exportToXml="false"
						exportXlsxButton="false">
						<hftl:column label="#{messages['commons.nameOrCode']}"
							field="nameOrCode">
						</hftl:column>
						<hftl:column label="#{messages['commons.category']}"
							field="offerTemplateCategories" isList="true"
							valueLabelField="descriptionOrCode">
						</hftl:column>
						<hftl:column label="#{messages['commons.validFrom']}"
							field="validFrom" isDate="true">
						</hftl:column>
						<hftl:column label="#{messages['commons.validTo']}"
							field="validTo" isDate="true">
						</hftl:column>
						<p:column>
							<f:facet name="header">#{messages['commons.status']}</f:facet>
							<p:inputSwitch value="#{entity.active}" disabled="true"
								onLabel="#{messages['accountStatusEnum.active']}"
								offLabel="#{messages['accountStatusEnum.inactive']}"></p:inputSwitch>
						</p:column>
						<p:column>
							<p:link outcome="mmProductTemplateDetail"
								styleClass="Padding5 fa fa-search-plus no-text-decoration text-red">
								<f:param name="cid"
									value="#{javax.enterprise.context.conversation.id}" />
								<f:param name="objectId" value="#{entity.id}"></f:param>
								<f:param name="edit" value="false"></f:param>
								<f:param name="backView" value="mmProductTemplates"></f:param>
								<f:param name="tab" value="1"></f:param>
							</p:link>
							<p:link
								styleClass="Padding5 fa fa-edit no-text-decoration text-red"
								outcome="mmProductTemplateDetail"
								rendered="#{not productTemplateBean.isBundleTemplate(entity)}">
								<f:param name="
								objectId" value="#{prod.id}">
								</f:param>
								<f:param name="cid"
									value="#{javax.enterprise.context.conversation.id}" />
								<f:param name="edit" value="true" />
								<f:param name="editMode" value="edit" />
								<f:param name="backView" value="mmProductTemplates"></f:param>
							</p:link>
							<p:link
								styleClass="Padding5 fa fa-edit no-text-decoration text-red"
								outcome="mmBundleTemplateDetail"
								rendered="#{productTemplateBean.isBundleTemplate(entity)}">
								<f:param name="objectId" value="#{entity.id}"></f:param>
								<f:param name="cid"
									value="#{javax.enterprise.context.conversation.id}" />
								<f:param name="edit" value="true" />
								<f:param name="editMode" value="edit" />
								<f:param name="backView" value="mmProductTemplates"></f:param>
							</p:link>
							<p:link
								styleClass="Padding5 fa fa-copy no-text-decoration text-red"
								outcome="mmProductTemplateDetail">
								<f:param name="objectId" value="#{entity.id}"></f:param>
								<f:param name="cid"
									value="#{javax.enterprise.context.conversation.id}" />
								<f:param name="edit" value="true" />
								<f:param name="editMode" value="dup" />
								<f:param name="backView" value="mmProductTemplates"></f:param>
							</p:link>
							<p:commandLink
								styleClass="Padding5 fa fa-share-square-o no-text-decoration text-red"
								action="#{productTemplateListBean.addProductTemplateToExport(entity)}"
								update=":productTemplateForm:ptToExport">
							</p:commandLink>
						</p:column>
					</hftl:dataList>
				</p:tab>
			</p:tabView>
		</h:form>
	</ui:define>

</ui:composition>
