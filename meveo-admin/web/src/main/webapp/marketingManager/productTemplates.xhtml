<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:hftl="http://hftl.org"
	xmlns:hf="http://java.sun.com/jsf/composite/tags"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui" xmlns:o="http://omnifaces.org/ui"
	template="/marketingManager/layout/template.xhtml">
	<ui:define name="metadata">
		<f:metadata>
			<f:event type="preRenderView"
				listener="#{productTemplateListBean.preRenderView}" />
		</f:metadata>
	</ui:define>

	<ui:define name="navigation">
		<ui:include src="/marketingManager/layout/navigation.xhtml" />
	</ui:define>

	<ui:define name="body">
		<h:form id="productTemplateForm">
			<p:panel id="headerPanel">
				<p:breadCrumb homeDisplay="text" id="crumbmenu">
					<p:menuitem value="#{messages['menu.catalog']}" disabled="true" />
					<p:menuitem outcome="mmProductTemplates"
						value="#{messages['productTemplates.search']}" />
				</p:breadCrumb>
				<p:panel style="width: 50%">
					<p:panelGrid columns="2" styleClass="ui-panelgrid-blank">
						<p:panel>
							<ul class="ListNoStyle">
								<li class="Padding5"><p:link styleClass="fa fa-plus-circle"
										outcome="mmProductTemplateDetail"
										value="#{messages['productTemplate.newProduct']}">
										<f:param name="cid"
											value="#{javax.enterprise.context.conversation.id}" />
										<f:param name="edit" value="true" />
										<f:param name="editMode" value="edit" />
									</p:link></li>
							</ul>
							<ul class="ListNoStyle">
								<li class="Padding5"><p:link styleClass="fa fa-plus-circle"
										outcome="mmBundleTemplateDetail"
										value="#{messages['productTemplate.createBundle']}">
										<f:param name="cid"
											value="#{javax.enterprise.context.conversation.id}" />
										<f:param name="edit" value="true" />
										<f:param name="editMode" value="edit" />
									</p:link></li>
							</ul>
						</p:panel>

						<p:panel>
							<ul class="ListNoStyle">
								<li class="Padding5"><span class="fa fa-check-square-o"></span>
									#{productTemplateListBean.activeProductCount}
									#{messages['productTemplate.activeProductsNum']}</li>
								<li class="Padding5"><span class="fa fa-close"></span>
									#{productTemplateListBean.inactiveProductCount}
									#{messages['productTemplate.deactivatedProductsNum']}</li>
								<li class="Padding5"><span class="fa fa-exclamation-circle"></span>
									#{productTemplateListBean.almostExpiredCount}
									#{messages['productTemplate.expiringProductsNum']}</li>
							</ul>
						</p:panel>
					</p:panelGrid>
				</p:panel>
				<p:panel id="ptToExport" style="width: 50%">
					<p:panelGrid columns="2" styleClass="ui-panelgrid-blank">
						<p:panel>
							<p:inputText placeholder="#{messages['action.search']}"
								syle="float:right;"
								value="#{productTemplateListBean.filters['FIELD1_OR_FIELD2 name description']}" />
							<p:commandLink styleClass="Padding3 fa fa-search"
								update=":productTemplateForm:productTemplateList"></p:commandLink>
						</p:panel>
						<p:panelGrid columns="1">
							<p:panel style="border: 1px solid #000" id="offerForExportPanel">
								<p:panelGrid columns="2">
									<h:outputText id="exportSize"
										value="#{messages['productTemplate.exportTo']}" />
									<p:selectOneMenu id="exportToList"
										value="#{productTemplateListBean.meveoInstanceToExport}">
										<f:selectItem itemLabel="" />
										<f:selectItems
											value="#{productTemplateListBean.meveoInstances}" var="mi"
											itemValue="#{mi}" itemLabel="#{mi.code}" />
									</p:selectOneMenu>
								</p:panelGrid>
							</p:panel>
						</p:panelGrid>
					</p:panelGrid>
				</p:panel>
				<!-- <p:panelGrid columns="3" layout="grid"
					styleClass="ui-panelgrid-blank" id="headerGrid">
					<p:panelGrid columns="2" styleClass="ui-panelgrid-blank">
						<span class="fa fa-plus-circle"> </span>
						<h:link id="newProduct" outcome="mmProductTemplateDetail"
							value="#{messages['productTemplate.newProduct']}">
							<f:param name="cid"
								value="#{javax.enterprise.context.conversation.id}" />
							<f:param name="edit" value="true" />
							<f:param name="editMode" value="edit" />
						</h:link>
						<span class="fa fa-plus-circle"> </span>
						<h:link id="createBundle" outcome="mmBundleTemplateDetail"
							value="#{messages['productTemplate.createBundle']}">
							<f:param name="cid"
								value="#{javax.enterprise.context.conversation.id}" />
							<f:param name="edit" value="true" />
							<f:param name="editMode" value="edit" />
						</h:link>
					</p:panelGrid>
					<p:panelGrid columns="2" styleClass="ui-panelgrid-blank">
						<span class="fa fa-check-square-o"></span>
						<p:panelGrid columns="2">
							<h:outputText
								value="#{productTemplateListBean.activeProductCount}" />
							<p:outputLabel
								value="#{messages['productTemplate.activeProductsNum']}" />
						</p:panelGrid>
						<span class="fa fa-close"></span>
						<p:panelGrid columns="2" styleClass="ui-panelgrid-blank">
							<h:outputText
								value="#{productTemplateListBean.inactiveProductCount}" />
							<p:outputLabel
								value="#{messages['productTemplate.deactivatedProductsNum']}" />
						</p:panelGrid>
						<span class="fa fa-exclamation-circle"></span>
						<p:panelGrid columns="2">
							<h:outputText
								value="#{productTemplateListBean.almostExpiredCount}" />
							<p:outputLabel
								value="#{messages['productTemplate.expiringProductsNum']}" />
						</p:panelGrid>
					</p:panelGrid>
					<p:panelGrid columns="1">
						<p:panelGrid columns="2">
							<span class="fa fa-share-square-o"></span>
							<h:outputText id="ptToExportSize"
								value="#{productTemplateListBean.ptToExport.size()} #{messages['productTemplate.selectedProductsfoExportNum']}" />
						</p:panelGrid>
						<p:panelGrid columns="1">
							<p:panelGrid columns="2">
								<h:outputText id="exportSize"
									value="#{messages['productTemplate.exportTo']}" />
								<p:selectOneMenu id="exportToList"
									value="#{productTemplateListBean.meveoInstanceToExport}">
									<f:selectItem itemLabel="" />
									<f:selectItems
										value="#{productTemplateListBean.meveoInstances}" var="mi"
										itemValue="#{mi}" itemLabel="#{mi.code}" />
								</p:selectOneMenu>
							</p:panelGrid>
						</p:panelGrid>
					</p:panelGrid>
				</p:panelGrid> -->
			</p:panel>
			<p:dataGrid id="productTemplateList" var="prod"
				value="#{productTemplateListBean.productTemplates}" paginator="true"
				rows="5" columns="1" paginatorPosition="top"
				paginatorAlwaysVisible="true" 
				paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
				lazy="true" styleClass="dataGrid custom-grid ui-panelgrid-blank ui-datagrid-blank" rowKey="#{prod.id}">

				<p:panelGrid columns="3" style="width: 100%"
					styleClass="ui-panelgrid-blank" id="productTemplateRow">
					<p:panelGrid columns="2" styleClass="ui-panelgrid-blank">
						<p:graphicImage id="productImage" cache="false"
							value="#{productTemplateImageStreamer.image}" height="100">
							<f:param name="id" value="#{prod.id}"></f:param>
						</p:graphicImage>
						<p:panelGrid columns="2">
							<h:outputText value="#{messages['commons.name']} : " />
							<h:outputText value="#{prod.name}" />
							<h:outputText value="#{messages['commons.validFrom']} : " />
							<h:outputText value="#{prod.validFrom}">
								<f:convertDateTime
									pattern="#{paramBean.getProperty('meveo.dateFormat','dd/MM/yyyy')}" />
							</h:outputText>
							<h:outputText value="#{messages['commons.validTo']} : " />
							<h:outputText value="#{prod.validTo}">
								<f:convertDateTime
									pattern="#{paramBean.getProperty('meveo.dateFormat','dd/MM/yyyy')}" />
							</h:outputText>
						</p:panelGrid>
					</p:panelGrid>
					<p:panelGrid columns="1" styleClass="ui-panelgrid-blank">
						<p:panel styleClass="TexAlRight">
							<div class="FRight">
								<p:inputSwitch value="#{prod.active}"
									onLabel="#{messages['accountStatusEnum.active']}"
									offLabel="#{messages['accountStatusEnum.inactive']}">
									<p:ajax
										listener="#{productTemplateListBean.updateProductTemplateStatus(prod)}" />
								</p:inputSwitch>
							</div>
							<div class="FRight" style="padding-top: 5px; margin-right: 10px;">#{messages['commons.status']}</div>
						</p:panel>
						<p:panelGrid columns="1">
							<p:outputLabel value="#{messages['commons.status']}" />
							<o:importConstants
								type="org.meveo.model.catalog.LifeCycleStatusEnum" />
							<p:selectOneMenu value="#{prod.lifeCycleStatus}">
								<p:ajax
									listener="#{productTemplateListBean.updateProductTemplateStatus(prod)}" />
								<f:selectItems value="#{LifeCycleStatusEnum}" var="lcStatus"
									itemLabel="#{messages[lcStatus.label]}"
									itemValue="#{lcStatus.value}" />
							</p:selectOneMenu>
						</p:panelGrid>
						<p:panel>
							<h:outputText value="#{messages['productTemplate.family']} : " />
							<h:outputText value="#{prod.businessProductModel.description}" />
						</p:panel>
						<p:panelGrid columns="3" styleClass="ui-panelgrid-blank">
							<!-- <h:link styleClass="fa fa-edit">
								<f:param name="objectId" value="#{prod.id}"></f:param>
								<f:param name="cid"
									value="#{javax.enterprise.context.conversation.id}" />
								<f:param name="edit" value="true" />
							</h:link> -->

							<h:link styleClass="fa fa-copy" outcome="mmProductTemplateDetail">
								<f:param name="objectId" value="#{prod.id}"></f:param>
								<f:param name="cid"
									value="#{javax.enterprise.context.conversation.id}" />
								<f:param name="edit" value="true" />
								<f:param name="editMode" value="dup" />
							</h:link>
							<h:link styleClass="fa fa-edit" outcome="mmProductTemplateDetail"
								rendered="#{not productTemplateBean.isBundleTemplate(prod)}">
								<f:param name="
								objectId" value="#{prod.id}">
								</f:param>
								<f:param name="cid"
									value="#{javax.enterprise.context.conversation.id}" />
								<f:param name="edit" value="true" />
								<f:param name="editMode" value="edit" />
							</h:link>
							<h:link styleClass="fa fa-edit" outcome="mmBundleTemplateDetail">
								<f:param name="objectId" value="#{prod.id}"
									rendered="#{productTemplateBean.isBundleTemplate(prod)}"></f:param>
								<f:param name="cid"
									value="#{javax.enterprise.context.conversation.id}" />
								<f:param name="edit" value="true" />
								<f:param name="editMode" value="edit" />
							</h:link>
							<p:commandLink styleClass="fa fa-share-square-o"
								action="#{productTemplateListBean.addProductTemplateToExport(prod)}"
								update=":productTemplateForm:ptToExport">

							</p:commandLink>
						</p:panelGrid>
					</p:panelGrid>
					<p:panelGrid columns="1" styleClass="ui-panelgrid-blank">
						<h:outputText
							value="#{messages['productTemplate.bundledProducts']}" />
						<p:dataGrid columns="4"
							value="#{productTemplateListBean.bundledProducts}" var="bp">
							<span class="fa fa-circle" />
							<h:outputText value="#{bp}" />
						</p:dataGrid>
					</p:panelGrid>
				</p:panelGrid>
			</p:dataGrid>
		</h:form>
	</ui:define>

</ui:composition>
