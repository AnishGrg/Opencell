<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://java.sun.com/jsf/html"
    xmlns:hftl="http://hftl.org" xmlns:hf="http://java.sun.com/jsf/composite/tags" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:p="http://primefaces.org/ui" xmlns:of="http://omnifaces.org/functions" xmlns:o="http://omnifaces.org/ui" template="/layout/template.xhtml">

    <ui:define name="metadata">
        <f:metadata>
            <f:event type="preRenderView" listener="#{offerTemplateListBean.preRenderView}" />
        </f:metadata>
    </ui:define>

    <ui:define name="body">
        <h:form id="crumbmenuForm">
            <p:breadCrumb homeDisplay="text" id="crumbmenu">
                <p:menuitem value="#{messages['menu.catalog']}" disabled="true" />
                <p:menuitem value="#{messages['menu.offers']}" outcome="mm_offers" />
                <p:menuitem value="#{messages['menu.catalog.newOffer']}" disabled="true" />
            </p:breadCrumb>
        </h:form>

        <p:panel>
            <p:panel style="width: 50%">
            </p:panel>
            <p:panel style="width: 50%" styleClass="TexAlRight">
                <h:form>
                    <p:panel>
                        <p:inputText placeholder="#{messages['action.search']}" syle="float:right;"
                            value="#{businessOfferModelListBean.filters['FIELD1_OR_FIELD2 offerTemplate.name offerTemplate.description']}" />
                        <p:commandLink styleClass="Padding3 fa fa-search" update=":mainForm:dataGrid"></p:commandLink>
                    </p:panel>
                </h:form>
            </p:panel>

            <h:form id="mainForm">
                <p:dataGrid id="dataGrid" value="#{businessOfferModelListBean.listActive()}" var="entity" paginator="true" rows="10" columns="1" layout="grid"
                    paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}" lazy="true"
                    styleClass="dataGrid custom-grid ui-datagrid-blank" rowsPerPageTemplate="10,15,20,50" rowKey="#{entity.id}">
                    <p:panel styleClass="Wid40 Responsive100 VAlignTop">
                        <p:panelGrid columns="2" columnClasses="Wid30 Responsive100, Wid70 Responsive100" styleClass="ui-panelgrid-blank">
                            <p:panel>
                                <p:graphicImage id="offerImage" cache="false" rendered="#{entity.offerTemplate ne null}" value="#{offerTemplateImageStreamer.image}" height="100"
                                    width="100">
                                    <f:param name="id" value="#{entity.offerTemplate.id}"></f:param>
                                </p:graphicImage>
                            </p:panel>
                            <p:panel styleClass="ui-panelgrid-blank">
                                <h:outputText id="descriptionOrCode" value="#{messages['offerTemplate.bom']}: #{of:abbreviate(entity.descriptionOrCode, 20)}"></h:outputText>
                                <p:tooltip for="descriptionOrCode" value="#{entity.descriptionOrCode}"></p:tooltip>
                                <ui:repeat value="#{entity.offerTemplate.offerTemplateCategories.toArray()}" var="c" varStatus="status">
                                    <c:set var="valueLabel" value="#{c}" />
                                    <c:set var="valueLabel" value="#{valueLabel['descriptionOrCode']}" />
                                    <h:outputText value="#{valueLabel}" />
                                    <h:outputText value=", " rendered="#{not status.last}" />
                                </ui:repeat>
                                <p:separator></p:separator>
                                <h:outputText value="#{entity.offerTemplate.nameOrCode}"></h:outputText>
                                <h:outputText value="#{entity.offerTemplate.description}"></h:outputText>

                                <p:panel>
                                    <ul class="list-inline text-center">
                                        <li><p:link styleClass="fa fa-2x fa-edit no-text-decoration text-red" outcome="mm_offerTemplateDetail">
                                                <f:param name="cid" value="#{javax.enterprise.context.conversation.id}" />
                                                <f:param name="objectId" value="#{entity.offerTemplate.id}"></f:param>
                                                <f:param name="edit" value="true"></f:param>
                                                <f:param name="backView" value="mm_offerTemplates"></f:param>
                                                <f:param name="tab" value="0"></f:param>
                                            </p:link></li>
                                        <li><p:link outcome="mm_offerTemplateDetail" styleClass="fa fa-2x fa-search-plus no-text-decoration text-red">
                                                <f:param name="cid" value="#{javax.enterprise.context.conversation.id}" />
                                                <f:param name="objectId" value="#{entity.offerTemplate.id}"></f:param>
                                                <f:param name="edit" value="false"></f:param>
                                                <f:param name="backView" value="mm_offerTemplates"></f:param>
                                                <f:param name="tab" value="0"></f:param>
                                            </p:link></li>
                                    </ul>
                                </p:panel>
                            </p:panel>
                        </p:panelGrid>
                    </p:panel>
                    <p:panel styleClass="Wid50 Responsive100 VAlignTop">
                        <p:dataGrid value="#{entity.offerTemplate.offerServiceTemplates}" var="ost" paginator="true" rows="20" columns="1" paginatorPosition="bottom"
                            paginatorAlwaysVisible="false"
                            paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}" lazy="true"
                            styleClass="custom-grid ui-datagrid-blank" style="border: none;" rowKey="#{ost.id}">
                            <p:panel>
                                <p:panel styleClass="Wid33 Responsive100 VAlignTop" header="#{messages['marketingManager.catalog.OneTimeFee']}">
                                    <p:dataList styleClass="dataList" paginatorPosition="bottom" paginatorAlwaysVisible="false"
                                        rendered="#{ost.serviceTemplate.serviceSubscriptionCharges != null}" value="#{ost.serviceTemplate.serviceSubscriptionCharges}" var="charge"
                                        type="ordered">
										#{charge.chargeTemplate.descriptionOrCode}
									</p:dataList>
                                </p:panel>
                                <p:panel styleClass="Wid33 Responsive100 VAlignTop" header="#{messages['marketingManager.catalog.recurringFee']}">
                                    <p:dataList styleClass="dataList" paginatorPosition="bottom" paginatorAlwaysVisible="false"
                                        rendered="#{ost.serviceTemplate.serviceRecurringCharges != null}" value="#{ost.serviceTemplate.serviceRecurringCharges}" var="charge"
                                        type="ordered">
										#{charge.chargeTemplate.descriptionOrCode}
									</p:dataList>
                                </p:panel>
                                <p:panel styleClass="Wid33 Responsive100 VAlignTop" header="#{messages['marketingManager.catalog.usageFee']}">
                                    <p:dataList styleClass="dataList" paginatorPosition="bottom" paginatorAlwaysVisible="false"
                                        rendered="#{ost.serviceTemplate.serviceUsageCharges != null}" value="#{ost.serviceTemplate.serviceUsageCharges}" var="charge" type="ordered">#{charge.chargeTemplate.descriptionOrCode}</p:dataList>
                                </p:panel>
                            </p:panel>
                        </p:dataGrid>
                    </p:panel>
                    <p:panel styleClass="Wid10 Responsive100 text-center">
                        <div class="Container100">
                            <p:panel header="#{messages['action.startWithThisTemplate']}">
                                <p:link styleClass="fa fa-2x fa-play no-text-decoration text-red" outcome="mm_offerTemplateDetail" value="">
                                    <f:param name="bomId" value="#{entity.id}"></f:param>
                                    <f:param name="objectId" value="#{entity.offerTemplate.id}"></f:param>
                                    <f:param name="edit" value="true"></f:param>
                                    <f:param name="backView" value="mm_offers"></f:param>
                                </p:link>
                            </p:panel>
                        </div>
                    </p:panel>
                </p:dataGrid>
            </h:form>

        </p:panel>

    </ui:define>
</ui:composition>
