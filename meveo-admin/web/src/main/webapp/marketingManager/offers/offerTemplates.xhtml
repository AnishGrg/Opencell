<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:hftl="http://hftl.org"
	xmlns:hf="http://java.sun.com/jsf/composite/tags"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:of="http://omnifaces.org/functions"
	xmlns:o="http://omnifaces.org/ui"
	template="/marketingManager/layout/template.xhtml">

	<ui:define name="metadata">
		<f:metadata>
			<f:event type="preRenderView"
				listener="#{offerTemplateListBean.preRenderView}" />
		</f:metadata>
	</ui:define>

	<ui:define name="navigation">
		<ui:include src="/marketingManager/layout/navigation.xhtml" />
	</ui:define>

	<ui:define name="body">
		<h:form id="crumbmenuForm">
			<p:breadCrumb homeDisplay="text" id="crumbmenu">
				<p:menuitem value="#{messages['menu.catalog']}" disabled="true" />
				<p:menuitem value="#{messages['menu.catalog.listOffers']}"
					outcome="mmOffers" />
			</p:breadCrumb>
		</h:form>

		<p:panel header="#{messages['menu.marketingManager.catalogView']}">
			<p:panel style="width: 50%">
			</p:panel>
			<p:panel style="width: 50%" styleClass="TexAlRight">
				<h:form>
					<p:panel>
						<p:inputText placeholder="#{messages['action.search']}"
							syle="float:right;"
							value="#{businessOfferModelListBean.filters['FIELD1_OR_FIELD2 offerTemplate.name offerTemplate.description']}" />
						<p:commandLink styleClass="Padding3 fa fa-search"
							update=":mainForm:dataGrid"></p:commandLink>
					</p:panel>
				</h:form>
			</p:panel>

			<h:form id="mainForm">
				<p:dataGrid id="dataGrid"
					value="#{businessOfferModelListBean.listActive()}" var="entity"
					paginator="true" rows="10" columns="1" layout="grid"
					paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
					lazy="true" styleClass="dataGrid custom-grid ui-datagrid-blank"
					rowsPerPageTemplate="10,15,20,50" rowKey="#{entity.id}">
					<p:panel styleClass="Wid40 VAlignTop">
						<p:panelGrid columns="2" columnClasses="Wid30, Wid70"
							styleClass="ui-panelgrid-blank">
							<p:panel>
								<p:graphicImage id="offerImage" cache="false"
									value="#{offerTemplateImageStreamer.image}" height="100"
									width="100">
									<f:param name="id" value="#{entity.offerTemplate.id}"></f:param>
								</p:graphicImage>
							</p:panel>
							<p:panel>
								<p:panelGrid columns="1" styleClass="ui-panelgrid-blank">
									<h:outputText value="#{entity.offerTemplate.nameOrCode}"></h:outputText>
									<ui:repeat
										value="#{entity.offerTemplate.offerTemplateCategories.toArray()}"
										var="c" varStatus="status">
										<c:set var="valueLabel" value="#{c}" />
										<c:set var="valueLabel"
											value="#{valueLabel['descriptionOrCode']}" />
										<h:outputText value="#{valueLabel}" />
										<h:outputText value=", " rendered="#{not status.last}" />
									</ui:repeat>
									<h:outputText
										value="#{messages['offerTemplate.bom']}: #{entity.offerTemplate.businessOfferModel.code}"
										rendered="#{entity.offerTemplate.businessOfferModel != null}"></h:outputText>
									<p:separator></p:separator>
									<h:outputText value="#{entity.offerTemplate.description}"></h:outputText>

									<p:panel>
										<ul class="list-inline text-center">
											<li><p:link
													styleClass="fa fa-2x fa-edit no-text-decoration text-red"
													outcome="mmOfferDetail">
													<f:param name="cid"
														value="#{javax.enterprise.context.conversation.id}" />
													<f:param name="objectId" value="#{entity.offerTemplate.id}"></f:param>
													<f:param name="edit" value="true"></f:param>
													<f:param name="backView" value="mmOfferTemplates"></f:param>
													<f:param name="tab" value="0"></f:param>
												</p:link></li>
											<li><p:link outcome="mmOfferDetail"
													styleClass="fa fa-2x fa-search-plus no-text-decoration text-red">
													<f:param name="cid"
														value="#{javax.enterprise.context.conversation.id}" />
													<f:param name="objectId" value="#{entity.offerTemplate.id}"></f:param>
													<f:param name="edit" value="false"></f:param>
													<f:param name="backView" value="mmOfferTemplates"></f:param>
													<f:param name="tab" value="0"></f:param>
												</p:link></li>
										</ul>
									</p:panel>
								</p:panelGrid>
							</p:panel>
						</p:panelGrid>
					</p:panel>
					<p:panel styleClass="Wid50 VAlignTop">
						<p:dataGrid value="#{entity.offerTemplate.offerServiceTemplates}"
							var="ost" paginator="true" rows="20" columns="1"
							paginatorPosition="bottom" paginatorAlwaysVisible="false"
							paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
							lazy="true" styleClass="custom-grid ui-datagrid-blank"
							style="border: none;" rowKey="#{ost.id}">
							<p:panel>
								<p:panel styleClass="Wid33 VAlignTop"
									header="#{messages['marketingManager.catalog.OneTimeFee']}">
									<p:dataList styleClass="dataList" paginatorPosition="bottom"
										paginatorAlwaysVisible="false"
										rendered="#{ost.serviceTemplate.serviceSubscriptionCharges != null}"
										value="#{ost.serviceTemplate.serviceSubscriptionCharges}"
										var="charge" type="ordered">
										#{charge.chargeTemplate.descriptionOrCode}
									</p:dataList>
								</p:panel>
								<p:panel styleClass="Wid33 VAlignTop"
									header="#{messages['marketingManager.catalog.recurringFee']}">
									<p:dataList styleClass="dataList" paginatorPosition="bottom"
										paginatorAlwaysVisible="false"
										rendered="#{ost.serviceTemplate.serviceRecurringCharges != null}"
										value="#{ost.serviceTemplate.serviceRecurringCharges}"
										var="charge" type="ordered">
										#{charge.chargeTemplate.descriptionOrCode}
									</p:dataList>
								</p:panel>
								<p:panel styleClass="Wid33 VAlignTop"
									header="#{messages['marketingManager.catalog.usageFee']}">
									<p:dataList styleClass="dataList" paginatorPosition="bottom"
										paginatorAlwaysVisible="false"
										rendered="#{ost.serviceTemplate.serviceUsageCharges != null}"
										value="#{ost.serviceTemplate.serviceUsageCharges}"
										var="charge" type="ordered">#{charge.chargeTemplate.descriptionOrCode}</p:dataList>
								</p:panel>
							</p:panel>
						</p:dataGrid>
					</p:panel>
					<p:panel styleClass="Wid10 text-center" style="position: relative; top: 50%; transform: translateY(-50%);">
						<p:panel header="#{messages['action.startWithThisTemplate']}">
							<p:link styleClass="fa fa-2x fa-play no-text-decoration text-red"
								outcome="mmOfferDetail" value="">
								<f:param name="bomId" value="#{entity.id}"></f:param>
								<f:param name="objectId" value="#{entity.offerTemplate.id}"></f:param>
								<f:param name="edit" value="true"></f:param>
								<f:param name="backView" value="mmOffers"></f:param>
							</p:link>
						</p:panel>
					</p:panel>
				</p:dataGrid>
			</h:form>

		</p:panel>

	</ui:define>
</ui:composition>
