<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:hftl="http://hftl.org"
	xmlns:hf="http://java.sun.com/jsf/composite/tags"
	xmlns:p="http://primefaces.org/ui" template="/layout/template.xhtml">

	<f:metadata>
		<f:event type="preRenderView"
			listener="#{pricePlanMatrixListBean.preRenderView}" />
	</f:metadata>
	<ui:define name="navigation">
		<ui:include src="/layout/navigation.xhtml" />
	</ui:define>

	<ui:define name="body">
		<hftl:entityPopup id="offerPopup"
			header="#{messages['offer.popup.header']}"
			backingBean="#{offerTemplateBean}"
			searchField1Label="#{messages['offerTemplate.code']}"
			searchField1="code"
			searchField2Label="#{messages['offerTemplate.description']}"
			searchField2="description"
			column1Label="#{messages['offerTemplate.code']}" column1="code"
			column2Label="#{messages['offerTemplate.description']}"
			column2="description"
			selection="#{pricePlanMatrixListBean.filters['offerTemplate']}"
			lazy="false" dataModel="#{offerTemplateBean.listActive}"
			updateField=":searchPanel:searchForm:offer:offerTemplate_child">
		</hftl:entityPopup>
		<hftl:entityPopup id="searchSellerPopup"
			header="#{messages['seller.search']}" backingBean="#{sellerBean}"
			searchField1Label="#{messages['BusinessEntity.code']}"
			searchField1="code" column1Label="#{messages['BusinessEntity.code']}"
			column1="code"
			column2Label="#{messages['BusinessEntity.description']}"
			column2="description"
			selection="#{pricePlanMatrixListBean.filters['seller']}"
			lazy="false" dataModel="#{sellerBean.listAll}"
			updateField=":searchPanel:searchForm:seller:seller_child">
		</hftl:entityPopup>
		<hftl:entityPopup id="searchTradingCountryPopup"
			header="#{messages['country.search']}"
			backingBean="#{tradingCountryBean}"
			searchField1Label="#{messages['BusinessEntity.description']}"
			searchField1="prDescription"
			column1Label="#{messages['BusinessEntity.code']}"
			column1="countryCode"
			column2Label="#{messages['BusinessEntity.description']}"
			column2="prDescription"
			selection="#{pricePlanMatrixListBean.filters['tradingCountry']}"
			lazy="false" dataModel="#{tradingCountryBean.listAll}"
			updateField=":searchPanel:searchForm:tradingCountry:tradingCountry_child">
		</hftl:entityPopup>
		<hftl:entityPopup id="searchTradingCurrencyPopup"
			header="#{messages['currency.search']}"
			backingBean="#{tradingCurrencyBean}"
			searchField1Label="#{messages['BusinessEntity.description']}"
			searchField1="prDescription"
			column1Label="#{messages['BusinessEntity.code']}"
			column1="currencyCode"
			column2Label="#{messages['BusinessEntity.description']}"
			column2="prDescription"
			selection="#{pricePlanMatrixListBean.filters['tradingCurrency']}"
			lazy="false" dataModel="#{tradingCurrencyBean.listAll}"
			updateField=":searchPanel:searchForm:tradingCurrency:tradingCurrency_child">
		</hftl:entityPopup>

		<hf:searchPanel id="searchPanel" columns="3"
			label="#{messages['pricePlanMatrix.search']}"
			backingBean="#{pricePlanMatrixListBean}">
			<hf:searchField label="#{messages['BusinessEntity.code']}"
				field="code" />
			<hf:searchField label="#{messages['pricePlanMatrix.eventCode']}"
				field="eventCode" />
			<hf:searchField id="offer"
				label="#{messages['pricePlanMatrix.offerCode']}"
				field="offerTemplate" childField="code" popup="true"
				popupId="offerPopup" clearButton="true" />
			<hf:searchField id="seller" label="#{messages['seller.title']}"
				field="seller" childField="description" popup="true"
				popupId="searchSellerPopup" clearButton="true" />
			<hf:searchField id="tradingCountry"
				label="#{messages['tradingCountry.tradingCountry']}"
				field="tradingCountry" childField="countryCode" popup="true"
				popupId="searchTradingCountryPopup" clearButton="true" />
			<hf:searchField id="tradingCurrency"
				label="#{messages['currency.codeCurrency']}" field="tradingCurrency"
				childField="currencyCode" popup="true"
				popupId="searchTradingCurrencyPopup" clearButton="true" />
			<hf:minmaxSearchField label="#{messages['pricePlanMatrix.quantity']}"
				minField="minQuantity" maxField="maxQuantity" />
			<hf:likeCriteriasSearchField
				label="#{messages['pricePlanMatrix.criteriaValue']}"
				fields="criteria1Value,criteria2Value,criteria3Value" />
			<hf:minmaxSearchField
				label="#{messages['pricePlanMatrix.subscriptionDate']}"
				minField="startSubscriptionDate" maxField="endSubscriptionDate" />
			<hf:minmaxSearchField
				label="#{messages['pricePlanMatrix.ratingDate']}"
				minField="startRatingDate" maxField="endRatingDate" />
			<hf:minmaxSearchField
				label="#{messages['pricePlanMatrix.subscriptionAgeInMonth']}"
				minField="minSubscriptionAgeInMonth"
				maxField="maxSubscriptionAgeInMonth" />
		</hf:searchPanel>

		<hftl:dataList label="#{messages['pricePlanMatrix.title']}"
			editable="true" editMode="cell" scrollable="true"
			backingBean="#{pricePlanMatrixListBean}" sortBy="code">
			<hftl:editColumn label="#{messages['BusinessEntity.code']}"
				sortBy="code" fieldValue="#{entity.code}" required="true"/>
			<hftl:editColumn label="#{messages['pricePlanMatrix.eventCode']}"
				fieldValue="#{entity.eventCode}" required="true"
				listValue="#{chargeTemplateBean.listAll}" itemLabel="#{item.code}"
				itemValue="#{item.code}" sortBy="eventCode" />
			<hftl:editColumn label="#{messages['BusinessEntity.description']}"
				fieldValue="#{entity.description}" sortBy="description" maxlength="100" required="true"/>
			<hftl:editColumn label="#{messages['pricePlanMatrix.offerCode']}"
				fieldValue="#{entity.offerTemplate}" fieldLabel="code"
				listValue="#{offerTemplateBean.listAll}" itemLabel="#{item.code}"
				itemValue="#{item}" sortBy="offerTemplate" />
			<hftl:editColumn label="#{messages['seller.title']}"
				fieldValue="#{entity.seller}" fieldLabel="code"
				listValue="#{sellerBean.listAll}" itemLabel="#{item.code}"
				itemValue="#{item}" />
			<hftl:editColumn label="#{messages['pricePlanMatrix.amountWithTax']}"
				rendered="#{!pricePlanMatrixBean.entity.provider.entreprise}"
				converterParam="4digits" converter="bigDecimal4DigitsConverter" fieldValue="#{entity.amountWithTax}" required="true"/>
			<hftl:editColumn
				label="#{messages['pricePlanMatrix.amountWithoutTax']}"
				fieldValue="#{entity.amountWithoutTax}" converterParam="4digits" converter="bigDecimal4DigitsConverter" required="true"/>

			<hftl:editColumn label="#{messages['pricePlanMatrix.criteriaEL']}"
				fieldValue="#{entity.criteriaEL}" rendered="false"/>
			<hftl:editColumn label="#{messages['tradingCountry.tradingCountry']}"
				fieldValue="#{entity.tradingCountry}" fieldLabel="countryCode"
				listValue="#{tradingCountryBean.listAll}"
				itemLabel="#{item.countryCode}" itemValue="#{item}" rendered="false"/>
			<hftl:editColumn label="#{messages['currency.codeCurrency']}"
				fieldValue="#{entity.tradingCurrency}" fieldLabel="currencyCode"
				listValue="#{tradingCurrencyBean.listAll}"
				itemLabel="#{item.currencyCode}" itemValue="#{item}" rendered="false"/>
			<hftl:editColumn
				label="#{messages['pricePlanMatrix.criteria1Value']}"
				fieldValue="#{entity.criteria1Value}" rendered="false"/>
			<hftl:editColumn
				label="#{messages['pricePlanMatrix.criteria2Value']}"
				fieldValue="#{entity.criteria1Value}" rendered="false"/>
			<hftl:editColumn
				label="#{messages['pricePlanMatrix.criteria3Value']}"
				fieldValue="#{entity.criteria1Value}" rendered="false"/>

			<hftl:editColumn
				label="#{messages['pricePlanMatrix.table.startRatingDate']}"
				fieldValue="#{entity.startRatingDate}" isDate="true" rendered="false"/>
			<hftl:editColumn
				label="#{messages['pricePlanMatrix.table.endRatingDate']}"
				fieldValue="#{entity.endRatingDate}" isDate="true"  rendered="false"/>
			<hftl:editColumn label="#{messages['pricePlanMatrix.priority']}"
				fieldValue="#{entity.priority}"  rendered="false"/>
			<hftl:editColumn label="#{messages['pricePlanMatrix.priority']}"
				fieldValue="#{entity.priority}"  rendered="false"/>
			<hftl:editColumn label="#{messages['pricePlanMatrix.minQuantity']}"
				fieldValue="#{entity.minQuantity}"  rendered="false"/>
			<hftl:editColumn label="#{messages['pricePlanMatrix.maxQuantity']}"
				fieldValue="#{entity.maxQuantity}"  rendered="false"/>
			<hftl:editColumn
				label="#{messages['pricePlanMatrix.minSubscriptionAgeInMonth']}"
				fieldValue="#{entity.minSubscriptionAgeInMonth}" rendered="false" />
			<hftl:editColumn
				label="#{messages['pricePlanMatrix.maxSubscriptionAgeInMonth']}"
				fieldValue="#{entity.maxSubscriptionAgeInMonth}"
				converter="bigDecimal4DigitsConverter"
				rendered="#{!pricePlanMatrixBean.entity.provider.entreprise and false}"
				required="true" />
			<hftl:editColumn
				label="#{messages['pricePlanMatrix.validityCalendar']}"  rendered="false"
				fieldValue="#{entity.validityCalendar}" isDate="true" />
			<hftl:actionsColumn
				permission="#{identity.hasPermission('catalog','catalogManagement')}" />
		</hftl:dataList>
	</ui:define>

</ui:composition>
