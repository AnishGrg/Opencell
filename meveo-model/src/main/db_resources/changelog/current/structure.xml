<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.2.xsd">
	<changeSet id="ticket670_20150322" author="sebastienMichea">
		<addColumn tableName="CAT_SERVICE_TEMPLATE">
			<column name="INVOICING_CALENDAR_ID" type="BIGINT"/>
		</addColumn>
		<addColumn tableName="BILLING_SERVICE_INSTANCE">
			<column name="INVOICING_CALENDAR_ID" type="BIGINT"/>
		</addColumn>
		<addColumn tableName="BILLING_CHARGE_INSTANCE">
			<column name="INVOICING_CALENDAR_ID" type="BIGINT"/>
		</addColumn>
		<addColumn tableName="BILLING_WALLET_OPERATION">
			<column name="INVOICING_DATE" type="TIMESTAMP WITHOUT TIME ZONE"/>
		</addColumn>
	</changeSet>
	<changeSet id="ticket678_20150326" author="AndriusKarpavicius">
		<dropColumn tableName="CRM_PROVIDER" columnName="PROVIDER_ID"/>
		<addUniqueConstraint constraintName="UK_CRM_PROVIDER" columnNames="CODE" tableName="CRM_PROVIDER" />
	</changeSet>
    <changeSet id="ticket528_20150327" author="AndriusKarpavicius">
        <addColumn tableName="BILLING_INVOICE_AGREGATE">
            <column name="DISCOUNT_PERCENT" type="numeric(23, 12)" />
        </addColumn>
    </changeSet>
	<changeSet id="ticket680_20150328" author='SebastienMichea'>
		<addColumn tableName="BILLING_CYCLE">
			<column name="TRANSACTION_DATE_DELAY" type="INT4"/>
		</addColumn>
		<addColumn tableName="BILLING_CYCLE">
			<column name="INVOICE_DATE_PRODUCTION_DELAY" type="INT4"/>
		</addColumn>
		<addColumn tableName="BILLING_BILLING_RUN">
			<column name="INVOICE_DATE" type="TIMESTAMP WITHOUT TIME ZONE"/>
		</addColumn>
		<addColumn tableName="BILLING_BILLING_RUN">
			<column name="LAST_TRANSACTION_DATE" type="TIMESTAMP WITHOUT TIME ZONE"/>
		</addColumn>
	</changeSet>
	<changeSet id="ticket674_20150330" author="SebastienMichea">
		<modifyDataType tableName="JOB_EXECUTION" columnName="REPORT" newDataType="TEXT"/>
	</changeSet>
	<changeSet id="ticket585_20150330" author="SebastienMichea">
		<addColumn tableName="CRM_CUSTOM_FIELD_INST">
			<column name="MEVEO_TIMER_ID" type="BIGINT"/>
		</addColumn>
		<addForeignKeyConstraint baseColumnNames="MEVEO_TIMER_ID"
			baseTableName="CRM_CUSTOM_FIELD_INST" constraintName="fk_customfieldinstmeveotimer"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id"
			referencedTableName="MEVEO_TIMER" />
		<dropUniqueConstraint tableName="crm_custom_field_inst" constraintName="uk_6yeqeouehb38bt3l7r0dy8a0k"/>
	    <addUniqueConstraint columnNames="code, subscription_id, account_id, charge_template_id,service_template_id,offer_template_id,access_id,provider_id"
			constraintName="uk_customfieldinst" deferrable="false"
			disabled="false" initiallyDeferred="false" tableName="crm_custom_field_inst" />
	</changeSet>
	<changeSet id="ticket552_20150331" author="Mbarek">
		<addColumn tableName="AR_DUNNING_PLAN_TRANSITION">
			<column name="CONDITION_EL" type="VARCHAR(1000)"/>
		</addColumn>
		<addColumn tableName="AR_ACTION_PLAN_ITEM">
			<column name="CONDITION_EL" type="VARCHAR(1000)"/>
		</addColumn>
	</changeSet>
	<changeSet id="ticket682_20150410" author="Mbarek">
		<dropTable cascadeConstraints="true" tableName="BILLING_INVOICE_CAT_COUNTRY"/>
		<dropColumn tableName="BILLING_INV_SUB_CAT_COUNTRY" columnName="DISCOUNT_CODE"/>
	</changeSet>
	<changeSet id="ticket542_20150413" author="AndriusKarpavicius">
		<dropTable cascadeConstraints="true" tableName="PROVIDER_TITLES"/>
	</changeSet>	
</databaseChangeLog>
