<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.2.xsd">

	<changeSet id="#655_20150522" author="EdwardLegaspi">
		<createTable tableName="ar_credit_category">
			<column name="id" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="version" type="INT4" />
			<column name="disabled" type="BOOL">
				<constraints nullable="false" />
				</column>
			<column name="created" type="TIMESTAMP WITHOUT TIME ZONE">
				<constraints nullable="false" />
			</column>
			<column name="updated" type="TIMESTAMP WITHOUT TIME ZONE" />
			<column name="code" type="VARCHAR(60)">
				<constraints nullable="false" />
			</column>
			<column name="description" type="VARCHAR(100)" />
			<column name="provider_id" type="BIGINT" />
			<column name="creator_id" type="BIGINT" />
			<column name="updater_id" type="BIGINT" />
		</createTable>
		<addUniqueConstraint columnNames="id"
			tableName="ar_credit_category" />
		<addForeignKeyConstraint constraintName="fk_adm_user_creator_ar_credit_category"
			referencedTableName="adm_user" baseColumnNames="creator_id"
			baseTableName="ar_credit_category" referencedColumnNames="id" />
		<addForeignKeyConstraint constraintName="fk_adm_user_updater_ar_credit_category"
			referencedTableName="adm_user" baseColumnNames="updater_id"
			baseTableName="ar_credit_category" referencedColumnNames="id" />

		<createSequence sequenceName="ar_credit_category_seq"
			startValue="6" />

		<addColumn tableName="ar_customer_account">
			<column name="credit_category_id" type="BIGINT" />
		</addColumn>
		<addForeignKeyConstraint constraintName="fk_ar_credit_category_ar_customer_account"
			referencedTableName="ar_credit_category" baseColumnNames="credit_category_id"
			baseTableName="ar_customer_account" referencedColumnNames="id" />

		<addColumn tableName="ar_dunning_plan">
			<column name="credit_category_id" type="BIGINT" />
		</addColumn>
		<addForeignKeyConstraint constraintName="fk_ar_credit_category_ar_dunning_plan"
			referencedTableName="ar_credit_category" baseColumnNames="credit_category_id"
			baseTableName="ar_dunning_plan" referencedColumnNames="id" />
		<dropUniqueConstraint tableName="ar_dunning_plan"
			constraintName="uk_qn6vfgeg5g2y4pb9y6qb8ogjo" />
		<addUniqueConstraint
			columnNames="credit_category_id, payment_method, provider_id, code"
			constraintName="uk_qn6vfgeg5g2y4pb9y6qb8ogjo" deferrable="false"
			disabled="false" initiallyDeferred="false" tableName="ar_dunning_plan" />
	</changeSet>


	<changeSet id="ticket787_20150522" author="Mbarek">
		<addUniqueConstraint columnNames="NAME,PROVIDER_ID"
			tableName="MEVEO_TIMER" constraintName="UK_MEVEO_TIMER" />
	</changeSet>

	<changeSet author="anasseh (generated)" id="1432229915728-1">
		<createTable tableName="com_meveo_instance">
			<column name="id" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="version" type="INT4" />
			<column name="disabled" type="BOOL">
				<constraints nullable="false" />
			</column>
			<column name="created" type="TIMESTAMP WITHOUT TIME ZONE">
				<constraints nullable="false" />
			</column>
			<column name="updated" type="TIMESTAMP WITHOUT TIME ZONE" />
			<column name="code" type="VARCHAR(60)">
				<constraints nullable="false" />
			</column>
			<column name="description" type="VARCHAR(100)" />
			<column name="as_vendor" type="VARCHAR(255)" />
			<column name="as_version" type="VARCHAR(255)" />
			<column name="creation_date" type="TIMESTAMP WITHOUT TIME ZONE" />
			<column name="hd_size" type="VARCHAR(255)" />
			<column name="installation_mode" type="VARCHAR(255)" />
			<column name="java_vendor" type="VARCHAR(255)" />
			<column name="java_version" type="VARCHAR(255)" />
			<column name="java_vm_name" type="VARCHAR(255)" />
			<column name="java_vm_version" type="VARCHAR(255)" />
			<column name="key_entreprise" type="VARCHAR(255)" />
			<column name="mac_address" type="VARCHAR(255)" />
			<column name="machine_vendor" type="VARCHAR(255)" />
			<column name="md5" type="VARCHAR(255)" />
			<column name="memory" type="VARCHAR(255)" />
			<column name="nb_cores" type="VARCHAR(255)" />
			<column name="os_arch" type="VARCHAR(255)" />
			<column name="os_name" type="VARCHAR(255)" />
			<column name="ps_version" type="VARCHAR(255)" />
			<column name="owner" type="VARCHAR(255)" />
			<column name="product_name" type="VARCHAR(255)" />
			<column name="product_version" type="VARCHAR(255)" />
			<column name="status" type="VARCHAR(255)" />
			<column name="update_date" type="TIMESTAMP WITHOUT TIME ZONE" />
			<column name="provider_id" type="BIGINT" />
			<column name="creator_id" type="BIGINT" />
			<column name="updater_id" type="BIGINT" />
			<column name="user_id" type="BIGINT" />
			<column name="customer_id" type="BIGINT" />
		</createTable>
	</changeSet>
	<changeSet author="anasseh (generated)" id="1432229915728-3">
		<addPrimaryKey columnNames="id" constraintName="com_meveo_instance_pkey"
			tableName="com_meveo_instance" />
	</changeSet>

	<changeSet author="anasseh (generated)" id="1432229915728-5">
		<addUniqueConstraint columnNames="code"
			constraintName="uk_p7r8cy3d1w7g8pir7rxq17071" deferrable="false"
			disabled="false" initiallyDeferred="false" tableName="com_meveo_instance" />
	</changeSet>

	<changeSet author="anasseh (generated)" id="1432229915728-6">
		<addForeignKeyConstraint baseColumnNames="customer_id"
			baseTableName="com_meveo_instance" constraintName="fk_398jtw7cvvcjmyalvke9iwoqw"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="crm_customer" />
	</changeSet>
	<changeSet author="anasseh (generated)" id="1432229915728-4">
		<addForeignKeyConstraint baseColumnNames="user_id"
			baseTableName="com_meveo_instance" constraintName="fk_userid"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="adm_user" />
	</changeSet>
	<changeSet author="anasseh (generated)" id="1432229915728-7">
		<addForeignKeyConstraint baseColumnNames="creator_id"
			baseTableName="com_meveo_instance" constraintName="fk_2kqwodw5jh9dju2f2m3853y0c"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="adm_user" />
	</changeSet>
	<changeSet author="anasseh (generated)" id="1432229915728-8">
		<addForeignKeyConstraint baseColumnNames="updater_id"
			baseTableName="com_meveo_instance" constraintName="fk_6mn1jku9a27nleamaqyke2c63"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="adm_user" />
	</changeSet>

	<changeSet author="anasseh (generated)" id="1432229915728-13">
		<addForeignKeyConstraint baseColumnNames="provider_id"
			baseTableName="com_meveo_instance" constraintName="fk_simrfknulxj9dfm6v03k4ejmh"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="crm_provider" />
	</changeSet>
	<changeSet author="anasseh (generated)" id="1432229915728-20">
		<createSequence sequenceName="com_meveo_instance_seq" />
	</changeSet>
	<changeSet id="#791_20150602-3" author="AndriusKarpavicius">
		<addColumn tableName="CRM_CUSTOM_FIELD_TMPL">
			<column name="versionable" type="BOOL" defaultValue="false">
				<constraints nullable="false" />
			</column>
			<column name="calendar_id" type="BIGINT" />
		</addColumn>

		<addColumn tableName="CRM_CUSTOM_FIELD_INST">
			<column name="versionable" type="BOOL" defaultValue="false">
				<constraints nullable="false" />
			</column>
			<column name="calendar_id" type="BIGINT" />
		</addColumn>

		<createTable tableName="CRM_CUSTOM_FIELD_PERIOD">
			<column name="id" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="version" type="INT4" />
			<column name="PRIORITY" type="INT4" defaultValue="0" />
			<column name="period_end_date" type="TIMESTAMP WITHOUT TIME ZONE" />
			<column name="period_start_date" type="TIMESTAMP WITHOUT TIME ZONE" />
			<column name="CF_INSTANCE_ID" type="BIGINT" />
			<column name="date_value" type="TIMESTAMP WITHOUT TIME ZONE" />
			<column name="double_value" type="FLOAT8" />
			<column name="long_value" type="BIGINT" />
			<column name="string_value" type="VARCHAR(255)" />
		</createTable>

		<addForeignKeyConstraint baseColumnNames="calendar_id"
			baseTableName="CRM_CUSTOM_FIELD_INST" constraintName="fk_CFI_CALENDAR"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="CAT_CALENDAR" />

		<addForeignKeyConstraint baseColumnNames="CF_INSTANCE_ID"
			baseTableName="CRM_CUSTOM_FIELD_PERIOD" constraintName="fk_CFP_CFI"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="CRM_CUSTOM_FIELD_INST" />
		<addForeignKeyConstraint baseColumnNames="calendar_id"
			baseTableName="CRM_CUSTOM_FIELD_TMPL" constraintName="fk_CFT_CALENDAR"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="CAT_CALENDAR" />
		<createSequence sequenceName="CRM_CUSTOM_FIELD_PERIOD_seq" />
	</changeSet>

	<changeSet id="#791_20150602-4" author="AndriusKarpavicius">
		<dropSequence sequenceName="CRM_CUSTOM_FIELD_PERIOD_seq" />
		<createSequence sequenceName="crm_custom_field_period_seq" />
	</changeSet>

	<changeSet id="#791_20150602-5" author="AndriusKarpavicius">
		<addUniqueConstraint
			columnNames="CF_INSTANCE_ID, period_start_date, period_end_date"
			tableName="crm_custom_field_period" constraintName="uk_crm_custom_field_period" />
	</changeSet>

	<changeSet id="#852_20150605-2" author="EdwardLegaspi">
		<addNotNullConstraint columnDataType="VARCHAR(255)"
			columnName="COUNTER_TYPE" defaultNullValue="USAGE" tableName="CAT_COUNTER_TEMPLATE" />
		<addNotNullConstraint columnDataType="VARCHAR(255)"
			columnName="COUNTER_LEVEL" defaultNullValue="UA" tableName="CAT_COUNTER_TEMPLATE" />
	</changeSet>

	<!-- #855 begin -->

	<changeSet author="anasseh" id="1433614968312-1">
		<sqlFile endDelimiter="" path="migrationJobs_beforeLiquibase.sql"
			relativeToChangelogFile="true" splitStatements="false" />
	</changeSet>


	<changeSet author="anasseh (generated)" id="1433614968312-2">
		<createSequence sequenceName="meveo_job_instance_seq" />
	</changeSet>

	<changeSet author="anasseh (generated)" id="1433614968312-4">
		<createTable tableName="meveo_job_instance">
			<column name="id" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="version" type="INT4" />
			<column name="disabled" type="BOOL">
				<constraints nullable="false" />
			</column>
			<column name="created" type="TIMESTAMP WITHOUT TIME ZONE">
				<constraints nullable="false" />
			</column>
			<column name="updated" type="TIMESTAMP WITHOUT TIME ZONE" />
			<column name="code" type="VARCHAR(60)">
				<constraints nullable="false" />
			</column>
			<column name="description" type="VARCHAR(100)" />
			<column name="active" type="BOOL">
				<constraints nullable="false" />
			</column>
			<column name="job_category" type="VARCHAR(255)" />
			<column name="job_template" type="VARCHAR(255)">
				<constraints nullable="false" />
			</column>
			<column name="parametres" type="VARCHAR(255)" />
			<column name="user_id" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="provider_id" type="BIGINT" />
			<column name="creator_id" type="BIGINT" />
			<column name="updater_id" type="BIGINT" />
			<column name="timerentity_id" type="BIGINT" />
		</createTable>
	</changeSet>


	<changeSet author="anasseh (generated)" id="1433614968312-7">
		<addColumn tableName="meveo_timer">
			<column name="code" type="varchar(60)">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>
	<changeSet author="anasseh (generated)" id="1433614968312-8">
		<addColumn tableName="meveo_timer">
			<column name="created" type="timestamp(29, 6)">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>
	<changeSet author="anasseh (generated)" id="1433614968312-9">
		<addColumn tableName="meveo_timer">
			<column name="creator_id" type="int8" />
		</addColumn>
	</changeSet>
	<changeSet author="anasseh (generated)" id="1433614968312-10">
		<addColumn tableName="meveo_timer">
			<column name="description" type="varchar(100)" />
		</addColumn>
	</changeSet>
	<changeSet author="anasseh (generated)" id="1433614968312-11">
		<addColumn tableName="meveo_timer">
			<column name="disabled" type="bool">
				<constraints nullable="false" />
			</column>
		</addColumn>
	</changeSet>
	<changeSet author="anasseh (generated)" id="1433614968312-12">
		<addColumn tableName="crm_custom_field_inst">
			<column name="job_instance_id" type="int8" />
		</addColumn>
	</changeSet>
	<changeSet author="anasseh (generated)" id="1433614968312-13">
		<addColumn tableName="job_execution">
			<column name="job_launcher" type="varchar(255)" />
		</addColumn>
	</changeSet>
	<changeSet author="anasseh (generated)" id="1433614968312-14">
		<addColumn tableName="meveo_timer">
			<column name="updated" type="timestamp(29, 6)" />
		</addColumn>
	</changeSet>
	<changeSet author="anasseh (generated)" id="1433614968312-15">
		<addColumn tableName="meveo_timer">
			<column name="updater_id" type="int8" />
		</addColumn>
	</changeSet>

	<changeSet author="anasseh (generated)" id="1433614968312-21">
		<addPrimaryKey columnNames="id" constraintName="meveo_job_instance_pkey"
			tableName="meveo_job_instance" />
	</changeSet>


	<changeSet author="anasseh (generated)" id="1433614968312-24">
		<addUniqueConstraint columnNames="job_template, provider_id"
			constraintName="uk_ljs744oets15tnlf4i6ehe7l6" deferrable="false"
			disabled="false" initiallyDeferred="false" tableName="meveo_job_instance" />
	</changeSet>
	<changeSet author="AndriusKarpavicius" id="1433614968312-24-1">
		<dropUniqueConstraint tableName="meveo_job_instance"
			constraintName="uk_ljs744oets15tnlf4i6ehe7l6" />
		<addUniqueConstraint columnNames="code, provider_id"
			constraintName="uk_meveo_job_instance" deferrable="false" disabled="false"
			initiallyDeferred="false" tableName="meveo_job_instance" />
	</changeSet>
	<changeSet author="anasseh (generated)" id="1433614968312-25">
		<addUniqueConstraint columnNames="code, provider_id"
			constraintName="uk_q4ys10jgsw0px36rcvwdajh47" deferrable="false"
			disabled="false" initiallyDeferred="false" tableName="meveo_timer" />
	</changeSet>
	<changeSet author="anasseh (generated)" id="1433614968312-26">
		<addUniqueConstraint
			columnNames="code, subscription_id, account_id, charge_template_id, service_template_id, offer_template_id, access_id, job_instance_id, provider_id"
			constraintName="uk_t8760asnmoo8x2t0k6m0my7mq" deferrable="false"
			disabled="false" initiallyDeferred="false" tableName="crm_custom_field_inst" />
	</changeSet>

	<changeSet author="anasseh (generated)" id="1433614968312-28">
		<addForeignKeyConstraint baseColumnNames="job_instance_id"
			baseTableName="crm_custom_field_inst" constraintName="fk_35l2eaa4jvweujsta65d2ott"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="meveo_job_instance" />
	</changeSet>
	<changeSet author="anasseh (generated)" id="1433614968312-29">
		<addForeignKeyConstraint baseColumnNames="timerentity_id"
			baseTableName="meveo_job_instance" constraintName="fk_4hgoocwc77rh6ne8fct0f2y2h"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="meveo_timer" />
	</changeSet>


	<changeSet author="anasseh (generated)" id="1433614968312-32">
		<addForeignKeyConstraint baseColumnNames="creator_id"
			baseTableName="meveo_job_instance" constraintName="fk_878td2111duoa64gifhuhymhl"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="adm_user" />
	</changeSet>


	<changeSet author="anasseh (generated)" id="1433614968312-35">
		<addForeignKeyConstraint baseColumnNames="updater_id"
			baseTableName="meveo_job_instance" constraintName="fk_bupocciymjlmb23huxxftyqtg"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="adm_user" />
	</changeSet>
	<changeSet author="anasseh (generated)" id="1433614968312-36">
		<addForeignKeyConstraint baseColumnNames="creator_id"
			baseTableName="meveo_timer" constraintName="fk_dnqwct997aixcp36wuvmxgy12"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="adm_user" />
	</changeSet>

	<changeSet author="anasseh (generated)" id="1433614968312-39">
		<addForeignKeyConstraint baseColumnNames="updater_id"
			baseTableName="meveo_timer" constraintName="fk_liim1csjv7v194u77ddt1dqdp"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="adm_user" />
	</changeSet>

	<changeSet author="anasseh (generated)" id="1433614968312-41">
		<addForeignKeyConstraint baseColumnNames="provider_id"
			baseTableName="meveo_job_instance" constraintName="fk_pwc74fn35sffdnmean6swyxha"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="crm_provider" />
	</changeSet>

	<changeSet author="anasseh (generated)" id="1433614968312-45">
		<dropForeignKeyConstraint baseTableName="crm_custom_field_inst"
			constraintName="fk_customfieldinstmeveotimer" />
	</changeSet>

	<changeSet author="anasseh (generated)" id="1433614968312-48">
		<dropUniqueConstraint constraintName="uk_customfieldinst"
			tableName="crm_custom_field_inst" />
	</changeSet>
	<changeSet author="anasseh (generated)" id="1433614968312-49">
		<dropUniqueConstraint constraintName="uk_meveo_timer"
			tableName="meveo_timer" />
	</changeSet>

	<changeSet author="anasseh (generated)" id="1433614968312-51">
		<dropColumn columnName="active" tableName="meveo_timer" />
	</changeSet>

	<changeSet author="anasseh (generated)" id="1433614968312-53">
		<dropColumn columnName="followingtimerid" tableName="meveo_timer" />
	</changeSet>
	<changeSet author="anasseh (generated)" id="1433614968312-54">
		<dropColumn columnName="job_category" tableName="meveo_timer" />
	</changeSet>
	<changeSet author="anasseh (generated)" id="1433614968312-55">
		<dropColumn columnName="job_name" tableName="meveo_timer" />
	</changeSet>
	<changeSet author="anasseh (generated)" id="1433614968312-56">
		<dropColumn columnName="jobname" tableName="meveo_timer" />
	</changeSet>
	<changeSet author="anasseh (generated)" id="1433614968312-57">
		<dropColumn columnName="meveo_timer_id" tableName="crm_custom_field_inst" />
	</changeSet>
	<changeSet author="anasseh (generated)" id="1433614968312-58">
		<dropColumn columnName="name" tableName="meveo_timer" />
	</changeSet>
	<changeSet author="anasseh (generated)" id="1433614968312-59">
		<dropColumn columnName="parametres" tableName="meveo_timer" />
	</changeSet>

	<changeSet author="anasseh (generated)" id="1433614968312-62">
		<dropColumn columnName="userid" tableName="meveo_timer" />
	</changeSet>

	<changeSet author="anasseh" id="1433614968312-63">
		<sqlFile endDelimiter="" path="migrationJobs_afterLiquibase.sql"
			relativeToChangelogFile="true" splitStatements="false" />
	</changeSet>


	<changeSet author="anasseh (generated)" id="855_2015-06-09">
		<addColumn tableName="MEVEO_JOB_INSTANCE">
			<column name="FOLLOWING_JOB_ID" type="BIGINT" />
		</addColumn>
		<addForeignKeyConstraint baseColumnNames="FOLLOWING_JOB_ID"
			baseTableName="meveo_job_instance" constraintName="fk_following_job_id"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="MEVEO_JOB_INSTANCE" />
	</changeSet>
	<!-- #855 end -->

	<changeSet id="790-20150610" author="AndriusKarpavicius">
		<addColumn tableName="CRM_CUSTOM_FIELD_TMPL">
			<column name="DEFAULT_VALUE" type="VARCHAR(50)" />
		</addColumn>
	</changeSet>

	<changeSet author="anasseh (generated)" id="878_2015-06-11">
		<createSequence sequenceName="meveo_script_instance_seq" />
		<createTable tableName="meveo_script_instance">
			<column name="id" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="version" type="INT4" />
			<column name="disabled" type="BOOL">
				<constraints nullable="false" />
			</column>
			<column name="created" type="TIMESTAMP WITHOUT TIME ZONE">
				<constraints nullable="false" />
			</column>
			<column name="updated" type="TIMESTAMP WITHOUT TIME ZONE" />
			<column name="code" type="VARCHAR(60)">
				<constraints nullable="false" />
			</column>
			<column name="description" type="VARCHAR(100)" />				
			<column name="script" type="VARCHAR(10000)">
				<constraints nullable="false" />
			</column>
			<column name="provider_id" type="BIGINT" />
			<column name="creator_id" type="BIGINT" />
			<column name="updater_id" type="BIGINT" />
		</createTable>

		<addPrimaryKey columnNames="id" constraintName="meveo_script_instance_pkey"
			tableName="meveo_script_instance" />
		<addUniqueConstraint columnNames="code, provider_id"
			constraintName="uk_meveo_script_instance" deferrable="false"
			disabled="false" initiallyDeferred="false" tableName="meveo_script_instance"/>
		<addForeignKeyConstraint baseColumnNames="creator_id"
			baseTableName="meveo_script_instance" constraintName="fk_meveoscript_creator"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="adm_user" />

		<addForeignKeyConstraint baseColumnNames="updater_id"
			baseTableName="meveo_script_instance" constraintName="fk_meveoscript_updater"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="adm_user" />

		<addForeignKeyConstraint baseColumnNames="provider_id"
			baseTableName="meveo_script_instance" constraintName="fk_meveoscript_provider"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="crm_provider" />

		<addColumn tableName="ADM_NOTIFICATION">
			<column name="SCRIPT_INSTANCE_ID" type="int8" />
		</addColumn>

		<createTable tableName="MEVEO_SCRIPT_INSTANCE_PARAMS">
			<column name="ScriptInstance_ID" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="params" type="VARCHAR(255)" />
			<column name="params_key" type="VARCHAR(255)">
				<constraints nullable="false" />
			</column>
		</createTable>

		<addPrimaryKey columnNames="ScriptInstance_ID, params_key"
			constraintName="PK_MEVEO_SCRIPT_INSTANCE_PARAMS" tableName="MEVEO_SCRIPT_INSTANCE_PARAMS" />

		<addForeignKeyConstraint baseColumnNames="ScriptInstance_ID"
			baseTableName="MEVEO_SCRIPT_INSTANCE_PARAMS" constraintName="fk_params_script_instance"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="meveo_script_instance" />

		<addForeignKeyConstraint baseColumnNames="SCRIPT_INSTANCE_ID"
			baseTableName="ADM_NOTIFICATION" constraintName="fk_notif_script_instance"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="meveo_script_instance" />
	</changeSet>
	
	<changeSet author="anasseh (generated)" id="878_2015-06-11_1">
			<dropUniqueConstraint tableName="meveo_script_instance"
			constraintName="uk_meveo_script_instance" />
	
			<addUniqueConstraint columnNames="code"
			constraintName="uk_meveo_script_instance" deferrable="false"
			disabled="false" initiallyDeferred="false" tableName="meveo_script_instance"/>
	</changeSet>
	
	<changeSet author="anasseh (generated)" id="878_2015-06-11_2">
			<addColumn tableName="meveo_script_instance">
			<column name="SRC_TYPE" type="VARCHAR(100)" />
		</addColumn>
		</changeSet>
		
	<changeSet id="ticket794_20150616" author="Mbarek">
		<addColumn tableName="CAT_COUNTER_TEMPLATE">
			<column name="CEILING_EXPRESSION_EL" type="VARCHAR(1000)"/>
		</addColumn>
	</changeSet>	
	
	<changeSet author="anasseh (generated)" id="878_2015-06-11_3">
		<dropTable cascadeConstraints="true"
            tableName="MEVEO_SCRIPT_INSTANCE_PARAMS"/>
            
		<createTable tableName="MEVEO_SCRIPT_INSTANCE_PARAMS">
			<column name="scriptinstance_id" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="params" type="VARCHAR(255)" />
			<column name="params_key" type="VARCHAR(255)">
				<constraints nullable="false" />
			</column>
		</createTable>

		<addPrimaryKey columnNames="scriptinstance_id, params_key"
			constraintName="PK_MEVEO_SCRIPT_INSTANCE_PARAMS" tableName="MEVEO_SCRIPT_INSTANCE_PARAMS" />

		<addForeignKeyConstraint baseColumnNames="scriptinstance_id"
			baseTableName="MEVEO_SCRIPT_INSTANCE_PARAMS" constraintName="fk_params_script_instance"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="meveo_script_instance" />

	</changeSet>       
	
	<changeSet author="anasseh (generated)" id="887_2015-06-19">
	
	    <createTable tableName="ADM_NOTIF_JOB">
            <column name="JOB_INSTANCE_ID" type="BIGINT"/>           
            <column name="id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <addPrimaryKey columnNames="id" constraintName="ADM_NOTIF_JOB_pkey" tableName="ADM_NOTIF_JOB"/>

		<addForeignKeyConstraint baseColumnNames="JOB_INSTANCE_ID"
			baseTableName="ADM_NOTIF_JOB" constraintName="fk_job_trigger_notif"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="MEVEO_JOB_INSTANCE" />
            
		<createTable tableName="ADM_NOTIF_JOB_PARAMS">
			<column name="jobtrigger_id" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="params" type="VARCHAR(255)" />
			<column name="params_key" type="VARCHAR(255)">
				<constraints nullable="false" />
			</column>
		</createTable>

		<addPrimaryKey columnNames="jobtrigger_id, params_key"
			constraintName="PK_ADM_NOTIF_JOB_PARAMS" tableName="ADM_NOTIF_JOB_PARAMS" />

		<addForeignKeyConstraint baseColumnNames="jobtrigger_id"
			baseTableName="ADM_NOTIF_JOB_PARAMS" constraintName="fk_params_job_trigger"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="ADM_NOTIF_JOB" />

	</changeSet>	
    <changeSet id="684" author="AndriusKarpavicius">
        <addUniqueConstraint columnNames="code, provider_id" constraintName="uk_billing_invoice_configuration" deferrable="false" disabled="false"
            initiallyDeferred="false" tableName="billing_invoice_configuration" />
    </changeSet>
	<changeSet id="789-2015623-1" author="TyshanShi">
		<addColumn tableName="CRM_CUSTOM_FIELD_TMPL">
            <column name="ENTITY_CLAZZ" type="varchar(255)"/>
        </addColumn>
        <addColumn tableName="CRM_CUSTOM_FIELD_INST">
            <column name="ENTITY_VALUE" type="varchar(255)"/>
        </addColumn>
	</changeSet>
	
	<changeSet id="ticket895_20150623" author="Mbarek">
		<addColumn tableName="RATING_EDR">
		<column name="PARAMETER_5" type="VARCHAR(255)"/>
		<column name="PARAMETER_6" type="VARCHAR(255)"/>
		<column name="PARAMETER_7" type="VARCHAR(255)"/>
		<column name="PARAMETER_8" type="VARCHAR(255)"/>
		<column name="PARAMETER_9" type="VARCHAR(255)"/>
		<column name="DATE_PARAMETER_1" type="TIMESTAMP WITHOUT TIME ZONE"/>
		<column name="DATE_PARAMETER_2" type="TIMESTAMP WITHOUT TIME ZONE"/>
		<column name="DATE_PARAMETER_3" type="TIMESTAMP WITHOUT TIME ZONE"/>
		<column name="DATE_PARAMETER_4" type="TIMESTAMP WITHOUT TIME ZONE"/>
		<column name="DATE_PARAMETER_5" type="TIMESTAMP WITHOUT TIME ZONE"/>
		<column name="DECIMAL_PARAMETER_1" type="numeric(23, 12)"/>
		<column name="DECIMAL_PARAMETER_2" type="numeric(23, 12)"/>
		<column name="DECIMAL_PARAMETER_3" type="numeric(23, 12)"/>
		<column name="DECIMAL_PARAMETER_4" type="numeric(23, 12)"/>
		<column name="DECIMAL_PARAMETER_5" type="numeric(23, 12)"/>
		</addColumn>
	</changeSet> 
	
	<changeSet id="ticket903_20150625" author="Mbarek">
		<addColumn tableName="RATING_EDR">
		<column name="ACCESS_CODE" type="VARCHAR(255)"/>
		</addColumn>
	</changeSet>
	<changeSet id="789_20150630_1" author="TyshanShi">
		<addColumn tableName="CRM_CUSTOM_FIELD_TMPL">
			<column name="STORAGE_TYPE" type="varchar(255)"/>
		</addColumn>
		<!-- date -->
		<createTable tableName="CRM_CUSTOM_FIELD_INST_DATE_LIST">
			<column name="CUSTOMFIELDINSTANCE_ID" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="DATELIST" type="TIMESTAMP WITHOUT TIME ZONE"/>
		</createTable>
		<addForeignKeyConstraint baseColumnNames="CUSTOMFIELDINSTANCE_ID"
			baseTableName="CRM_CUSTOM_FIELD_INST_DATE_LIST" constraintName="fk_17rhtrdn4ejg92v2r0kqb1rn6"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="CRM_CUSTOM_FIELD_INST" />
		<createTable tableName="CRM_CUSTOM_FIELD_INST_DATE_MAP">
			<column name="CUSTOMFIELDINSTANCE_ID" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="DATEMAP_KEY" type="VARCHAR(255)"/>
			<column name="DATEMAP" type="TIMESTAMP WITHOUT TIME ZONE"/>
		</createTable>
		<addForeignKeyConstraint baseColumnNames="CUSTOMFIELDINSTANCE_ID"
			baseTableName="CRM_CUSTOM_FIELD_INST_DATE_MAP" constraintName="fk_f4ng0tdoqvn52hpdr1lpedj5a"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="CRM_CUSTOM_FIELD_INST" />
		<!-- long -->
		<createTable tableName="CRM_CUSTOM_FIELD_INST_LONG_LIST">
			<column name="CUSTOMFIELDINSTANCE_ID" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="LONGLIST" type="BIGINT"/>
		</createTable>
		<addForeignKeyConstraint baseColumnNames="CUSTOMFIELDINSTANCE_ID"
			baseTableName="CRM_CUSTOM_FIELD_INST_LONG_LIST" constraintName="fk_1gvv6bnuh584j4fiq4jq5wjbj"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="CRM_CUSTOM_FIELD_INST" />
		<createTable tableName="CRM_CUSTOM_FIELD_INST_LONG_MAP">
			<column name="CUSTOMFIELDINSTANCE_ID" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="LONGMAP_KEY" type="VARCHAR(255)"/>
			<column name="LONGMAP" type="BIGINT"/>
		</createTable>
		<addForeignKeyConstraint baseColumnNames="CUSTOMFIELDINSTANCE_ID"
			baseTableName="CRM_CUSTOM_FIELD_INST_LONG_MAP" constraintName="fk_14kjq164eqf0s0lf9hj9ph3yf"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="CRM_CUSTOM_FIELD_INST" />
		
		<!-- double -->
		<createTable tableName="CRM_CUSTOM_FIELD_INST_DOUB_LIST">
			<column name="CUSTOMFIELDINSTANCE_ID" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="DOUBLELIST" type="float8"/>
		</createTable>
		<addForeignKeyConstraint baseColumnNames="CUSTOMFIELDINSTANCE_ID"
			baseTableName="CRM_CUSTOM_FIELD_INST_DOUB_LIST" constraintName="fk_t7qdueeagl42j4ol5jhe9347f"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="CRM_CUSTOM_FIELD_INST" />
		<createTable tableName="CRM_CUSTOM_FIELD_INST_DOUB_MAP">
			<column name="CUSTOMFIELDINSTANCE_ID" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="DOUBLEMAP_KEY" type="VARCHAR(255)"/>
			<column name="DOUBLEMAP" type="float8"/>
		</createTable>
		<addForeignKeyConstraint baseColumnNames="CUSTOMFIELDINSTANCE_ID"
			baseTableName="CRM_CUSTOM_FIELD_INST_DOUB_MAP" constraintName="fk_m2ebwk97gh5mxvfmic66k0j0y"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="CRM_CUSTOM_FIELD_INST" />
		<!-- string -->
		<createTable tableName="CRM_CUSTOM_FIELD_INST_STR_LIST">
			<column name="CUSTOMFIELDINSTANCE_ID" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="STRINGLIST" type="varchar(255)"/>
		</createTable>
		<addForeignKeyConstraint baseColumnNames="CUSTOMFIELDINSTANCE_ID"
			baseTableName="CRM_CUSTOM_FIELD_INST_STR_LIST" constraintName="fk_ivjnwp66uktesnuxjcs4xaewu"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="CRM_CUSTOM_FIELD_INST" />
		<createTable tableName="CRM_CUSTOM_FIELD_INST_STR_MAP">
			<column name="CUSTOMFIELDINSTANCE_ID" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="STRINGMAP_KEY" type="VARCHAR(255)"/>
			<column name="STRINGMAP" type="VARCHAR(255)"/>
		</createTable>
		<addForeignKeyConstraint baseColumnNames="CUSTOMFIELDINSTANCE_ID"
			baseTableName="CRM_CUSTOM_FIELD_INST_STR_MAP" constraintName="fk_hqkd0t9i2xw7jvi2d5v36fc2q"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="CRM_CUSTOM_FIELD_INST" />
		<addColumn tableName="CRM_CUSTOM_FIELD_PERIOD">
			<column name="ENTITY_VALUE" type="varchar(255)"></column>
		</addColumn>
	</changeSet>
	
	<changeSet author="anasseh" id="#907_01072015">
        <modifyDataType columnName="string_value" newDataType="varchar(4000)"   tableName="crm_custom_field_inst"/>
    </changeSet>
	
    <changeSet id="805_20150701" author="AndriusKarpavicius">
        <addColumn tableName="COM_MEVEO_INSTANCE">
            <column name="URL" type="VARCHAR(60)" defaultValue="http://"/>            
        </addColumn>
        <addNotNullConstraint tableName="COM_MEVEO_INSTANCE" columnName="URL"/>    
    </changeSet>
    
    <changeSet id="789_2015703_1" author="TyshanShi">
        <dropAllForeignKeyConstraints baseTableName="CRM_CUSTOM_FIELD_INST_DATE_LIST"/>
        <dropTable tableName="CRM_CUSTOM_FIELD_INST_DATE_LIST"/>
        <dropAllForeignKeyConstraints baseTableName="CRM_CUSTOM_FIELD_INST_DATE_MAP"/>
        <dropTable tableName="CRM_CUSTOM_FIELD_INST_DATE_MAP"/>
        <dropAllForeignKeyConstraints baseTableName="CRM_CUSTOM_FIELD_INST_LONG_LIST"/>
        <dropTable tableName="CRM_CUSTOM_FIELD_INST_LONG_LIST"/>
        <dropAllForeignKeyConstraints baseTableName="CRM_CUSTOM_FIELD_INST_LONG_MAP"/>
        <dropTable tableName="CRM_CUSTOM_FIELD_INST_LONG_MAP"/>
        <dropAllForeignKeyConstraints baseTableName="CRM_CUSTOM_FIELD_INST_DOUB_LIST"/>
        <dropTable tableName="CRM_CUSTOM_FIELD_INST_DOUB_LIST"/>
        <dropAllForeignKeyConstraints baseTableName="CRM_CUSTOM_FIELD_INST_DOUB_MAP"/>
        <dropTable tableName="CRM_CUSTOM_FIELD_INST_DOUB_MAP"/>
        <dropAllForeignKeyConstraints baseTableName="CRM_CUSTOM_FIELD_INST_STR_LIST"/>
        <dropTable tableName="CRM_CUSTOM_FIELD_INST_STR_LIST"/>
        <dropAllForeignKeyConstraints baseTableName="CRM_CUSTOM_FIELD_INST_STR_MAP"/>
        <dropTable tableName="CRM_CUSTOM_FIELD_INST_STR_MAP"/>
        <modifyDataType columnName="entity_value" newDataType="text"   tableName="CRM_CUSTOM_FIELD_INST"/>
        <modifyDataType columnName="entity_value" newDataType="text"   tableName="CRM_CUSTOM_FIELD_PERIOD"/>
    </changeSet>
    
     <changeSet id="797_20150706" author="Mbarek"> 
     <sql>update CRM_CUSTOM_FIELD_INST set PROVIDER_ID=null</sql> 
    </changeSet>
    
    <changeSet id="#941_20150710" author="smichea">
		<addColumn tableName="RATING_EDR">
			<column name="HEADER_EDR_ID" type="BIGINT">
				<constraints nullable="true" />
			</column>
	    </addColumn>
		<addForeignKeyConstraint baseColumnNames="HEADER_EDR_ID"
			baseTableName="RATING_EDR" constraintName="fk_headeredrid"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="RATING_EDR" />
    </changeSet>
    
    <changeSet id="#950_20150717" author="smichea">
        <addColumn tableName="BILLING_WALLET_OPERATION">
            <column name="EDR_ID" type="BIGINT">
                <constraints nullable="true" />
            </column>
        </addColumn>
        <addForeignKeyConstraint baseColumnNames="EDR_ID"
            baseTableName="BILLING_WALLET_OPERATION" constraintName="fk_wopEdrId"
            deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
            onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="RATING_EDR" />
        <addColumn tableName="BILLING_RATED_TRANSACTION">
            <column name="EDR_ID" type="BIGINT">
                <constraints nullable="true" />
            </column>
        </addColumn>
        <addForeignKeyConstraint baseColumnNames="EDR_ID"
            baseTableName="BILLING_RATED_TRANSACTION" constraintName="fk_ropEdrId"
            deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
            onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="RATING_EDR" />
    </changeSet>

	<changeSet id="#947_20150721" author="EdwardLegaspi">
		<addColumn tableName="CRM_CUSTOM_FIELD_INST">
			<column name="TRIGGER_END_PERIOD_EVENT" type="boolean"
				defaultValueBoolean="false" />
		</addColumn>
		<addColumn tableName="CRM_CUSTOM_FIELD_TMPL">
			<column name="TRIGGER_END_PERIOD_EVENT" type="boolean"
				defaultValueBoolean="false" />
		</addColumn>
	</changeSet>
	
	<changeSet id="#948_20150723" author="smichea">
        <addColumn tableName="CAT_PRICE_PLAN_MATRIX">
            <column name="AMOUNT_WITHOUT_TAX_EL" type="VARCHAR(2000)">
                <constraints nullable="true" />
            </column>
        </addColumn>
        <addColumn tableName="CAT_PRICE_PLAN_MATRIX">
            <column name="AMOUNT_WITH_TAX_EL" type="VARCHAR(2000)">
                <constraints nullable="true" />
            </column>
        </addColumn>
   	</changeSet>
</databaseChangeLog>
