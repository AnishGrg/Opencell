<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.2.xsd">

	<changeSet author="EdwardLegaspi" id="#1087_20150922">
		<createTable tableName="meveo_filter_parameter">
			<column name="id" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="version" type="INT4" />
			<column name="disabled" type="BOOL">
				<constraints nullable="false" />
			</column>
			<column name="created" type="TIMESTAMP WITHOUT TIME ZONE">
				<constraints nullable="false" />
			</column>
			<column name="updated" type="TIMESTAMP WITHOUT TIME ZONE" />
			<column name="provider_id" type="BIGINT" />
			<column name="creator_id" type="BIGINT" />
			<column name="updater_id" type="BIGINT" />
			<column name="code" type="VARCHAR(60)">
				<constraints nullable="false" />
			</column>
			<column name="description" type="VARCHAR(100)" />
			<column name="default_value" type="VARCHAR(50)" />
			<column name="value_required" type="BOOL" />
			<column name="field_type" type="VARCHAR(255)" />
			<column name="entity_clazz" type="VARCHAR(255)" />
			<column name="filter_id" type="BIGINT" />
		</createTable>

		<addPrimaryKey columnNames="id" constraintName="meveo_filter_parameter_pkey"
			tableName="meveo_filter_parameter" />

		<addForeignKeyConstraint baseColumnNames="provider_id"
			baseTableName="meveo_filter_parameter" constraintName="fk_meveo_filter_parameter_crm_provider"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="crm_provider" />
		
		<addForeignKeyConstraint baseColumnNames="creator_id"
			baseTableName="meveo_filter_parameter" constraintName="fk_creator_meveo_filter_parameter_adm_user"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="adm_user" />
		
		<addForeignKeyConstraint baseColumnNames="updater_id"
			baseTableName="meveo_filter_parameter" constraintName="fk_updater_meveo_filter_parameter_adm_user"
			deferrable="false" initiallyDeferred="false" onDelete="NO ACTION"
			onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="adm_user" />
		
		<addForeignKeyConstraint baseColumnNames="filter_id"
			baseTableName="meveo_filter_parameter" constraintName="fk_meveo_filter_parameter_meveo_filter"
			deferrable="false" initiallyDeferred="false" onDelete="CASCADE"
			onUpdate="CASCADE" referencedColumnNames="id" referencedTableName="meveo_filter" />

		<createTable tableName="meveo_filter_parameter_list_val">
			<column name="filterparameter_id" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="listvalues" type="VARCHAR(255)" />
			<column name="listvalues_key" type="VARCHAR(255)">
				<constraints nullable="false" />
			</column>
		</createTable>

		<createSequence sequenceName="meveo_filter_parameter_seq" />
	</changeSet>

	<changeSet author="anasseh" id="20150928_text">
     	<modifyDataType columnName="string_value" newDataType="text"   tableName="CRM_CUSTOM_FIELD_INST"/>
     </changeSet>
    
</databaseChangeLog>
