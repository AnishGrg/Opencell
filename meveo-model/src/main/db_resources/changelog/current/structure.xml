<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.2.xsd">

	<changeSet id="#655_20150522" author="EdwardLegaspi">
		<createTable tableName="ar_credit_category">
			<column name="id" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="version" type="INT4" />
			<column name="disabled" type="BOOL">
				<constraints nullable="false" />
			</column>
			<column name="created" type="TIMESTAMP WITHOUT TIME ZONE">
				<constraints nullable="false" />
			</column>
			<column name="updated" type="TIMESTAMP WITHOUT TIME ZONE" />
			<column name="code" type="VARCHAR(60)">
				<constraints nullable="false" />
			</column>
			<column name="description" type="VARCHAR(100)" />
			<column name="provider_id" type="BIGINT" />
			<column name="creator_id" type="BIGINT" />
			<column name="updater_id" type="BIGINT" />
		</createTable>
		<addUniqueConstraint columnNames="id"
			tableName="ar_credit_category" />
		<addForeignKeyConstraint constraintName="fk_adm_user_creator_ar_credit_category"
			referencedTableName="adm_user" baseColumnNames="creator_id"
			baseTableName="ar_credit_category" referencedColumnNames="id" />
		<addForeignKeyConstraint constraintName="fk_adm_user_updater_ar_credit_category"
			referencedTableName="adm_user" baseColumnNames="updater_id"
			baseTableName="ar_credit_category" referencedColumnNames="id" />

		<createSequence sequenceName="ar_credit_category_seq"
			startValue="6" />

		<addColumn tableName="ar_customer_account">
			<column name="credit_category_id" type="BIGINT" />
		</addColumn>
		<addForeignKeyConstraint constraintName="fk_ar_credit_category_ar_customer_account"
			referencedTableName="ar_credit_category" baseColumnNames="credit_category_id"
			baseTableName="ar_customer_account" referencedColumnNames="id" />

		<addColumn tableName="ar_dunning_plan">
			<column name="credit_category_id" type="BIGINT" />
		</addColumn>
		<addForeignKeyConstraint constraintName="fk_ar_credit_category_ar_dunning_plan"
			referencedTableName="ar_credit_category" baseColumnNames="credit_category_id"
			baseTableName="ar_dunning_plan" referencedColumnNames="id" />
		<dropUniqueConstraint tableName="ar_dunning_plan"
			constraintName="uk_qn6vfgeg5g2y4pb9y6qb8ogjo" />
		<addUniqueConstraint
			columnNames="credit_category_id, payment_method, provider_id, code"
			constraintName="uk_qn6vfgeg5g2y4pb9y6qb8ogjo" deferrable="false"
			disabled="false" initiallyDeferred="false" tableName="ar_dunning_plan" />
	</changeSet>


<changeSet id="ticket787_20150522" author="Mbarek">
		<addUniqueConstraint columnNames="NAME,PROVIDER_ID" tableName="MEVEO_TIMER" constraintName="UK_MEVEO_TIMER"/>
	</changeSet>
	
	   <changeSet author="anasseh (generated)" id="1432229915728-1">
        <createTable tableName="com_meveo_instance">
            <column name="id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="version" type="INT4"/>
            <column name="disabled" type="BOOL">
                <constraints nullable="false"/>
            </column>
            <column name="created" type="TIMESTAMP WITHOUT TIME ZONE">
                <constraints nullable="false"/>
            </column>
            <column name="updated" type="TIMESTAMP WITHOUT TIME ZONE"/>
            <column name="code" type="VARCHAR(60)">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="VARCHAR(100)"/>
            <column name="as_vendor" type="VARCHAR(255)"/>
            <column name="as_version" type="VARCHAR(255)"/>
            <column name="creation_date" type="TIMESTAMP WITHOUT TIME ZONE"/>
            <column name="hd_size" type="VARCHAR(255)"/>
            <column name="installation_mode" type="VARCHAR(255)"/>
            <column name="java_vendor" type="VARCHAR(255)"/>
            <column name="java_version" type="VARCHAR(255)"/>
            <column name="java_vm_name" type="VARCHAR(255)"/>
            <column name="java_vm_version" type="VARCHAR(255)"/>
            <column name="key_entreprise" type="VARCHAR(255)"/>
            <column name="mac_address" type="VARCHAR(255)"/>
            <column name="machine_vendor" type="VARCHAR(255)"/>
            <column name="md5" type="VARCHAR(255)"/>
            <column name="memory" type="VARCHAR(255)"/>
            <column name="nb_cores" type="VARCHAR(255)"/>
            <column name="os_arch" type="VARCHAR(255)"/>
            <column name="os_name" type="VARCHAR(255)"/>
            <column name="ps_version" type="VARCHAR(255)"/>
            <column name="owner" type="VARCHAR(255)"/>
            <column name="product_name" type="VARCHAR(255)"/>
            <column name="product_version" type="VARCHAR(255)"/>
            <column name="status" type="VARCHAR(255)"/>
            <column name="update_date" type="TIMESTAMP WITHOUT TIME ZONE"/>
            <column name="provider_id" type="BIGINT"/>
            <column name="creator_id" type="BIGINT"/>
            <column name="updater_id" type="BIGINT"/>
             <column name="user_id" type="BIGINT"/>
             <column name="customer_id" type="BIGINT"/>
        </createTable>
    </changeSet>
    <changeSet author="anasseh (generated)" id="1432229915728-3">
        <addPrimaryKey columnNames="id" constraintName="com_meveo_instance_pkey" tableName="com_meveo_instance"/>
    </changeSet>

    <changeSet author="anasseh (generated)" id="1432229915728-5">
        <addUniqueConstraint columnNames="code" constraintName="uk_p7r8cy3d1w7g8pir7rxq17071" deferrable="false" disabled="false" initiallyDeferred="false" tableName="com_meveo_instance"/>
    </changeSet>
    
     <changeSet author="anasseh (generated)" id="1432229915728-6">
        <addForeignKeyConstraint baseColumnNames="customer_id" baseTableName="com_meveo_instance" constraintName="fk_398jtw7cvvcjmyalvke9iwoqw" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="crm_customer"/>
    </changeSet>
        <changeSet author="anasseh (generated)" id="1432229915728-4">
        <addForeignKeyConstraint baseColumnNames="user_id" baseTableName="com_meveo_instance" constraintName="fk_userid" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="adm_user"/>
    </changeSet>
    <changeSet author="anasseh (generated)" id="1432229915728-7">
        <addForeignKeyConstraint baseColumnNames="creator_id" baseTableName="com_meveo_instance" constraintName="fk_2kqwodw5jh9dju2f2m3853y0c" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="adm_user"/>
    </changeSet>
    <changeSet author="anasseh (generated)" id="1432229915728-8">
        <addForeignKeyConstraint baseColumnNames="updater_id" baseTableName="com_meveo_instance" constraintName="fk_6mn1jku9a27nleamaqyke2c63" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="adm_user"/>
    </changeSet>

    <changeSet author="anasseh (generated)" id="1432229915728-13">
        <addForeignKeyConstraint baseColumnNames="provider_id" baseTableName="com_meveo_instance" constraintName="fk_simrfknulxj9dfm6v03k4ejmh" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="crm_provider"/>
    </changeSet>
    <changeSet author="anasseh (generated)" id="1432229915728-20">
        <createSequence sequenceName="com_meveo_instance_seq"/>
    </changeSet>
	<changeSet id="#791_20150602-3" author="AndriusKarpavicius">
		<addColumn tableName="CRM_CUSTOM_FIELD_TMPL">
			<column name="versionable" type="BOOL" defaultValue="false">
                <constraints nullable="false"/>
            </column>
			<column name="calendar_id" type="BIGINT"/>
		</addColumn>
		
		<addColumn tableName="CRM_CUSTOM_FIELD_INST">
			<column name="versionable" type="BOOL" defaultValue="false">
                <constraints nullable="false"/>
            </column>
			<column name="calendar_id" type="BIGINT"/>
		</addColumn>
				
		<createTable tableName="CRM_CUSTOM_FIELD_PERIOD">
            <column name="id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="version" type="INT4"/>
            <column name="PRIORITY" type="INT4" defaultValue="0"/>
            <column name="period_end_date" type="TIMESTAMP WITHOUT TIME ZONE"/>
            <column name="period_start_date" type="TIMESTAMP WITHOUT TIME ZONE"/>
            <column name="CF_INSTANCE_ID" type="BIGINT"/>
            <column name="date_value" type="TIMESTAMP WITHOUT TIME ZONE"/>
            <column name="double_value" type="FLOAT8"/>
            <column name="long_value" type="BIGINT"/>
            <column name="string_value" type="VARCHAR(255)"/>
        </createTable>	
        
        <addForeignKeyConstraint baseColumnNames="calendar_id" baseTableName="CRM_CUSTOM_FIELD_INST" constraintName="fk_CFI_CALENDAR" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="CAT_CALENDAR"/>
        
        <addForeignKeyConstraint baseColumnNames="CF_INSTANCE_ID" baseTableName="CRM_CUSTOM_FIELD_PERIOD" constraintName="fk_CFP_CFI" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="CRM_CUSTOM_FIELD_INST"/>
        <addForeignKeyConstraint baseColumnNames="calendar_id" baseTableName="CRM_CUSTOM_FIELD_TMPL" constraintName="fk_CFT_CALENDAR" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="CAT_CALENDAR"/>
        <createSequence sequenceName="CRM_CUSTOM_FIELD_PERIOD_seq"/>
	</changeSet>
</databaseChangeLog>
